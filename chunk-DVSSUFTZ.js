import{a as It,b as cs,c as ls,d as L,e as kt,f as Et,i as vr,j as us,k as At,l as _t}from"./chunk-KOY6NI4W.js";import{$ as y,A as Mn,Aa as Ce,Ab as pr,B as q,Ba as Ie,Bb as Ct,C as fe,Ca as qn,Cb as gr,D as xn,Da as Wn,E as cr,Ea as Gn,Eb as mr,F as ce,Fa as Jn,G as Pn,Ga as Kn,Gb as os,H as yt,Ha as Qn,Hb as as,I as Te,Ia as Zn,J as W,Ja as me,K as lr,L as Dn,La as Be,M as On,N as Un,O as $,P as Nn,Q as x,R as A,Ra as Xn,S as le,Ta as Yn,V as R,W as je,X as Ln,Xa as es,Y as _,Ya as ts,Z as ur,_ as w,a as m,aa as Fe,b as U,ba as jn,ca as $e,d as te,da as Fn,e as Rn,f as Cn,fa as pe,g as sr,gb as rs,h as ir,ha as $n,i as or,ia as Re,j as X,ja as K,k as V,ka as zn,l as ae,m as N,n as p,na as ze,o as re,oa as Hn,p as In,pa as wt,q as kn,qa as He,r as En,ra as G,rb as ns,s as C,sa as hr,t as Le,u as F,ua as Bn,ub as St,v as An,va as bt,vb as ss,w as ar,wa as Vn,wb as Tt,xa as ge,xb as Rt,y as _n,yb as fr,z as P,za as dr,zb as is}from"./chunk-FTNGTGBB.js";var qe=class{},xt=class{},D=class r{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?typeof n=="string"?this.lazyInit=()=>{this.headers=new Map,n.split(`
`).forEach(e=>{let t=e.indexOf(":");if(t>0){let s=e.slice(0,t),i=s.toLowerCase(),o=e.slice(t+1).trim();this.maybeSetNormalizedName(s,i),this.headers.has(i)?this.headers.get(i).push(o):this.headers.set(i,[o])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((e,t)=>{this.setHeaderEntries(t,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([e,t])=>{this.setHeaderEntries(e,t)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();let e=this.headers.get(n.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,e){return this.clone({name:n,value:e,op:"a"})}set(n,e){return this.clone({name:n,value:e,op:"s"})}delete(n,e){return this.clone({name:n,value:e,op:"d"})}maybeSetNormalizedName(n,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,n)}init(){this.lazyInit&&(this.lazyInit instanceof r?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(e=>{this.headers.set(e,n.headers.get(e)),this.normalizedNames.set(e,n.normalizedNames.get(e))})}clone(n){let e=new r;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof r?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([n]),e}applyUpdate(n){let e=n.name.toLowerCase();switch(n.op){case"a":case"s":let t=n.value;if(typeof t=="string"&&(t=[t]),t.length===0)return;this.maybeSetNormalizedName(n.name,e);let s=(n.op==="a"?this.headers.get(e):void 0)||[];s.push(...t),this.headers.set(e,s);break;case"d":let i=n.value;if(!i)this.headers.delete(e),this.normalizedNames.delete(e);else{let o=this.headers.get(e);if(!o)return;o=o.filter(c=>i.indexOf(c)===-1),o.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,o)}break}}setHeaderEntries(n,e){let t=(Array.isArray(e)?e:[e]).map(i=>i.toString()),s=n.toLowerCase();this.headers.set(s,t),this.maybeSetNormalizedName(n,s)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>n(this.normalizedNames.get(e),this.headers.get(e)))}};var wr=class{encodeKey(n){return hs(n)}encodeValue(n){return hs(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}};function wi(r,n){let e=new Map;return r.length>0&&r.replace(/^\?/,"").split("&").forEach(s=>{let i=s.indexOf("="),[o,c]=i==-1?[n.decodeKey(s),""]:[n.decodeKey(s.slice(0,i)),n.decodeValue(s.slice(i+1))],a=e.get(o)||[];a.push(c),e.set(o,a)}),e}var bi=/%(\d[a-f0-9])/gi,Si={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function hs(r){return encodeURIComponent(r).replace(bi,(n,e)=>Si[e]??n)}function Mt(r){return`${r}`}var z=class r{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new wr,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=wi(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(e=>{let t=n.fromObject[e],s=Array.isArray(t)?t.map(Mt):[Mt(t)];this.map.set(e,s)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();let e=this.map.get(n);return e?e[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,e){return this.clone({param:n,value:e,op:"a"})}appendAll(n){let e=[];return Object.keys(n).forEach(t=>{let s=n[t];Array.isArray(s)?s.forEach(i=>{e.push({param:t,value:i,op:"a"})}):e.push({param:t,value:s,op:"a"})}),this.clone(e)}set(n,e){return this.clone({param:n,value:e,op:"s"})}delete(n,e){return this.clone({param:n,value:e,op:"d"})}toString(){return this.init(),this.keys().map(n=>{let e=this.encoder.encodeKey(n);return this.map.get(n).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(n=>n!=="").join("&")}clone(n){let e=new r({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(n),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":let e=(n.op==="a"?this.map.get(n.param):void 0)||[];e.push(Mt(n.value)),this.map.set(n.param,e);break;case"d":if(n.value!==void 0){let t=this.map.get(n.param)||[],s=t.indexOf(Mt(n.value));s!==-1&&t.splice(s,1),t.length>0?this.map.set(n.param,t):this.map.delete(n.param)}else{this.map.delete(n.param);break}}}),this.cloneFrom=this.updates=null)}};var br=class{constructor(){this.map=new Map}set(n,e){return this.map.set(n,e),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}};function Ti(r){switch(r){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function ds(r){return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer}function fs(r){return typeof Blob<"u"&&r instanceof Blob}function ps(r){return typeof FormData<"u"&&r instanceof FormData}function Ri(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}var Ve=class r{constructor(n,e,t,s){this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase();let i;if(Ti(this.method)||s?(this.body=t!==void 0?t:null,i=s):i=t,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.context&&(this.context=i.context),i.params&&(this.params=i.params),this.transferCache=i.transferCache),this.headers??=new D,this.context??=new br,!this.params)this.params=new z,this.urlWithParams=e;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=e;else{let c=e.indexOf("?"),a=c===-1?"?":c<e.length-1?"&":"";this.urlWithParams=e+a+o}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||ds(this.body)||fs(this.body)||ps(this.body)||Ri(this.body)?this.body:this.body instanceof z?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||ps(this.body)?null:fs(this.body)?this.body.type||null:ds(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof z?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(n={}){let e=n.method||this.method,t=n.url||this.url,s=n.responseType||this.responseType,i=n.transferCache??this.transferCache,o=n.body!==void 0?n.body:this.body,c=n.withCredentials??this.withCredentials,a=n.reportProgress??this.reportProgress,l=n.headers||this.headers,h=n.params||this.params,u=n.context??this.context;return n.setHeaders!==void 0&&(l=Object.keys(n.setHeaders).reduce((f,d)=>f.set(d,n.setHeaders[d]),l)),n.setParams&&(h=Object.keys(n.setParams).reduce((f,d)=>f.set(d,n.setParams[d]),h)),new r(e,t,o,{params:h,headers:l,context:u,reportProgress:a,responseType:s,withCredentials:c,transferCache:i})}},he=function(r){return r[r.Sent=0]="Sent",r[r.UploadProgress=1]="UploadProgress",r[r.ResponseHeader=2]="ResponseHeader",r[r.DownloadProgress=3]="DownloadProgress",r[r.Response=4]="Response",r[r.User=5]="User",r}(he||{}),We=class{constructor(n,e=200,t="OK"){this.headers=n.headers||new D,this.status=n.status!==void 0?n.status:e,this.statusText=n.statusText||t,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}},Pt=class r extends We{constructor(n={}){super(n),this.type=he.ResponseHeader}clone(n={}){return new r({headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},Ge=class r extends We{constructor(n={}){super(n),this.type=he.Response,this.body=n.body!==void 0?n.body:null}clone(n={}){return new r({body:n.body!==void 0?n.body:this.body,headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},ue=class extends We{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${n.url||"(unknown url)"}`:this.message=`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}},ys=200,Ci=204;function yr(r,n){return{body:n,headers:r.headers,context:r.context,observe:r.observe,params:r.params,reportProgress:r.reportProgress,responseType:r.responseType,withCredentials:r.withCredentials,transferCache:r.transferCache}}var Cr=(()=>{class r{constructor(e){this.handler=e}request(e,t,s={}){let i;if(e instanceof Ve)i=e;else{let a;s.headers instanceof D?a=s.headers:a=new D(s.headers);let l;s.params&&(s.params instanceof z?l=s.params:l=new z({fromObject:s.params})),i=new Ve(e,t,s.body!==void 0?s.body:null,{headers:a,context:s.context,params:l,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let o=p(i).pipe(fe(a=>this.handler.handle(a)));if(e instanceof Ve||s.observe==="events")return o;let c=o.pipe(P(a=>a instanceof Ge));switch(s.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return c.pipe(C(a=>{if(a.body!==null&&!(a.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return a.body}));case"blob":return c.pipe(C(a=>{if(a.body!==null&&!(a.body instanceof Blob))throw new Error("Response is not a Blob.");return a.body}));case"text":return c.pipe(C(a=>{if(a.body!==null&&typeof a.body!="string")throw new Error("Response is not a string.");return a.body}));case"json":default:return c.pipe(C(a=>a.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(e,t={}){return this.request("DELETE",e,t)}get(e,t={}){return this.request("GET",e,t)}head(e,t={}){return this.request("HEAD",e,t)}jsonp(e,t){return this.request("JSONP",e,{params:new z().append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,t={}){return this.request("OPTIONS",e,t)}patch(e,t,s={}){return this.request("PATCH",e,yr(s,t))}post(e,t,s={}){return this.request("POST",e,yr(s,t))}put(e,t,s={}){return this.request("PUT",e,yr(s,t))}static{this.\u0275fac=function(t){return new(t||r)(w(qe))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),Ii=/^\)\]\}',?\n/,ki="X-Request-URL";function gs(r){if(r.url)return r.url;let n=ki.toLocaleLowerCase();return r.headers.get(n)}var Ei=(()=>{class r{constructor(){this.fetchImpl=y(Sr,{optional:!0})?.fetch??((...e)=>globalThis.fetch(...e)),this.ngZone=y(G)}handle(e){return new sr(t=>{let s=new AbortController;return this.doRequest(e,s.signal,t).then(Tr,i=>t.error(new ue({error:i}))),()=>s.abort()})}doRequest(e,t,s){return te(this,null,function*(){let i=this.createRequestInit(e),o;try{let d=this.ngZone.runOutsideAngular(()=>this.fetchImpl(e.urlWithParams,m({signal:t},i)));Ai(d),s.next({type:he.Sent}),o=yield d}catch(d){s.error(new ue({error:d,status:d.status??0,statusText:d.statusText,url:e.urlWithParams,headers:d.headers}));return}let c=new D(o.headers),a=o.statusText,l=gs(o)??e.urlWithParams,h=o.status,u=null;if(e.reportProgress&&s.next(new Pt({headers:c,status:h,statusText:a,url:l})),o.body){let d=o.headers.get("content-length"),g=[],v=o.body.getReader(),b=0,E,T,k=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>te(this,null,function*(){for(;;){let{done:ee,value:oe}=yield v.read();if(ee)break;if(g.push(oe),b+=oe.length,e.reportProgress){T=e.responseType==="text"?(T??"")+(E??=new TextDecoder).decode(oe,{stream:!0}):void 0;let Tn=()=>s.next({type:he.DownloadProgress,total:d?+d:void 0,loaded:b,partialText:T});k?k.run(Tn):Tn()}}}));let ie=this.concatChunks(g,b);try{let ee=o.headers.get("Content-Type")??"";u=this.parseBody(e,ie,ee)}catch(ee){s.error(new ue({error:ee,headers:new D(o.headers),status:o.status,statusText:o.statusText,url:gs(o)??e.urlWithParams}));return}}h===0&&(h=u?ys:0),h>=200&&h<300?(s.next(new Ge({body:u,headers:c,status:h,statusText:a,url:l})),s.complete()):s.error(new ue({error:u,headers:c,status:h,statusText:a,url:l}))})}parseBody(e,t,s){switch(e.responseType){case"json":let i=new TextDecoder().decode(t).replace(Ii,"");return i===""?null:JSON.parse(i);case"text":return new TextDecoder().decode(t);case"blob":return new Blob([t],{type:s});case"arraybuffer":return t.buffer}}createRequestInit(e){let t={},s=e.withCredentials?"include":void 0;if(e.headers.forEach((i,o)=>t[i]=o.join(",")),e.headers.has("Accept")||(t.Accept="application/json, text/plain, */*"),!e.headers.has("Content-Type")){let i=e.detectContentTypeHeader();i!==null&&(t["Content-Type"]=i)}return{body:e.serializeBody(),method:e.method,headers:t,credentials:s}}concatChunks(e,t){let s=new Uint8Array(t),i=0;for(let o of e)s.set(o,i),i+=o.length;return s}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),Sr=class{};function Tr(){}function Ai(r){r.then(Tr,Tr)}function _i(r,n){return n(r)}function Mi(r,n,e){return(t,s)=>K(e,()=>n(t,i=>r(i,s)))}var ws=new _(""),bs=new _(""),xi=new _(""),Pi=new _("",{providedIn:"root",factory:()=>!0});var ms=(()=>{class r extends qe{constructor(e,t){super(),this.backend=e,this.injector=t,this.chain=null,this.pendingTasks=y(wt),this.contributeToStability=y(Pi)}handle(e){if(this.chain===null){let t=Array.from(new Set([...this.injector.get(bs),...this.injector.get(xi,[])]));this.chain=t.reduceRight((s,i)=>Mi(s,i,this.injector),_i)}if(this.contributeToStability){let t=this.pendingTasks.add();return this.chain(e,s=>this.backend.handle(s)).pipe(Te(()=>this.pendingTasks.remove(t)))}else return this.chain(e,t=>this.backend.handle(t))}static{this.\u0275fac=function(t){return new(t||r)(w(xt),w(Re))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})();var Di=/^\)\]\}',?\n/;function Oi(r){return"responseURL"in r&&r.responseURL?r.responseURL:/^X-Request-URL:/m.test(r.getAllResponseHeaders())?r.getResponseHeader("X-Request-URL"):null}var vs=(()=>{class r{constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new A(-2800,!1);let t=this.xhrFactory;return(t.\u0275loadImpl?N(t.\u0275loadImpl()):p(null)).pipe($(()=>new sr(i=>{let o=t.build();if(o.open(e.method,e.urlWithParams),e.withCredentials&&(o.withCredentials=!0),e.headers.forEach((v,b)=>o.setRequestHeader(v,b.join(","))),e.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){let v=e.detectContentTypeHeader();v!==null&&o.setRequestHeader("Content-Type",v)}if(e.responseType){let v=e.responseType.toLowerCase();o.responseType=v!=="json"?v:"text"}let c=e.serializeBody(),a=null,l=()=>{if(a!==null)return a;let v=o.statusText||"OK",b=new D(o.getAllResponseHeaders()),E=Oi(o)||e.url;return a=new Pt({headers:b,status:o.status,statusText:v,url:E}),a},h=()=>{let{headers:v,status:b,statusText:E,url:T}=l(),k=null;b!==Ci&&(k=typeof o.response>"u"?o.responseText:o.response),b===0&&(b=k?ys:0);let ie=b>=200&&b<300;if(e.responseType==="json"&&typeof k=="string"){let ee=k;k=k.replace(Di,"");try{k=k!==""?JSON.parse(k):null}catch(oe){k=ee,ie&&(ie=!1,k={error:oe,text:k})}}ie?(i.next(new Ge({body:k,headers:v,status:b,statusText:E,url:T||void 0})),i.complete()):i.error(new ue({error:k,headers:v,status:b,statusText:E,url:T||void 0}))},u=v=>{let{url:b}=l(),E=new ue({error:v,status:o.status||0,statusText:o.statusText||"Unknown Error",url:b||void 0});i.error(E)},f=!1,d=v=>{f||(i.next(l()),f=!0);let b={type:he.DownloadProgress,loaded:v.loaded};v.lengthComputable&&(b.total=v.total),e.responseType==="text"&&o.responseText&&(b.partialText=o.responseText),i.next(b)},g=v=>{let b={type:he.UploadProgress,loaded:v.loaded};v.lengthComputable&&(b.total=v.total),i.next(b)};return o.addEventListener("load",h),o.addEventListener("error",u),o.addEventListener("timeout",u),o.addEventListener("abort",u),e.reportProgress&&(o.addEventListener("progress",d),c!==null&&o.upload&&o.upload.addEventListener("progress",g)),o.send(c),i.next({type:he.Sent}),()=>{o.removeEventListener("error",u),o.removeEventListener("abort",u),o.removeEventListener("load",h),o.removeEventListener("timeout",u),e.reportProgress&&(o.removeEventListener("progress",d),c!==null&&o.upload&&o.upload.removeEventListener("progress",g)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(t){return new(t||r)(w(_t))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),Ss=new _(""),Ui="XSRF-TOKEN",Ni=new _("",{providedIn:"root",factory:()=>Ui}),Li="X-XSRF-TOKEN",ji=new _("",{providedIn:"root",factory:()=>Li}),Dt=class{},Fi=(()=>{class r{constructor(e,t,s){this.doc=e,this.platform=t,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Et(e,this.cookieName),this.lastCookieString=e),this.lastToken}static{this.\u0275fac=function(t){return new(t||r)(w(L),w(ge),w(Ni))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})();function $i(r,n){let e=r.url.toLowerCase();if(!y(Ss)||r.method==="GET"||r.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return n(r);let t=y(Dt).getToken(),s=y(ji);return t!=null&&!r.headers.has(s)&&(r=r.clone({headers:r.headers.set(s,t)})),n(r)}function Pc(...r){let n=[Cr,vs,ms,{provide:qe,useExisting:ms},{provide:xt,useFactory:()=>y(Ei,{optional:!0})??y(vs)},{provide:bs,useValue:$i,multi:!0},{provide:Ss,useValue:!0},{provide:Dt,useClass:Fi}];for(let e of r)n.push(...e.\u0275providers);return pe(n)}var Er=class extends ls{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Ar=class r extends Er{static makeCurrent(){cs(new r)}onAndCancel(n,e,t){return n.addEventListener(e,t),()=>{n.removeEventListener(e,t)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.remove()}createElement(n,e){return e=e||this.getDefaultDocument(),e.createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return e==="window"?window:e==="document"?n:e==="body"?n.body:null}getBaseHref(n){let e=qi();return e==null?null:Wi(e)}resetBaseElement(){Je=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return Et(document.cookie,n)}},Je=null;function qi(){return Je=Je||document.querySelector("base"),Je?Je.getAttribute("href"):null}function Wi(r){return new URL(r,document.baseURI).pathname}var _r=class{addToWindow(n){le.getAngularTestability=(t,s=!0)=>{let i=n.findTestabilityInTree(t,s);if(i==null)throw new A(5103,!1);return i},le.getAllAngularTestabilities=()=>n.getAllTestabilities(),le.getAllAngularRootElements=()=>n.getAllRootElements();let e=t=>{let s=le.getAllAngularTestabilities(),i=s.length,o=function(){i--,i==0&&t()};s.forEach(c=>{c.whenStable(o)})};le.frameworkStabilizers||(le.frameworkStabilizers=[]),le.frameworkStabilizers.push(e)}findTestabilityInTree(n,e,t){if(e==null)return null;let s=n.getTestability(e);return s??(t?It().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},Gi=(()=>{class r{build(){return new XMLHttpRequest}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),Mr=new _(""),Is=(()=>{class r{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(s=>{s.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,t,s){return this._findPluginFor(t).addEventListener(e,t,s)}getZone(){return this._zone}_findPluginFor(e){let t=this._eventNameToPlugin.get(e);if(t)return t;if(t=this._plugins.find(i=>i.supports(e)),!t)throw new A(5101,!1);return this._eventNameToPlugin.set(e,t),t}static{this.\u0275fac=function(t){return new(t||r)(w(Mr),w(G))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),Ot=class{constructor(n){this._doc=n}},Ir="ng-app-id",ks=(()=>{class r{constructor(e,t,s,i={}){this.doc=e,this.appId=t,this.nonce=s,this.platformId=i,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=At(i),this.resetHostNodes()}addStyles(e){for(let t of e)this.changeUsageCount(t,1)===1&&this.onStyleAdded(t)}removeStyles(e){for(let t of e)this.changeUsageCount(t,-1)<=0&&this.onStyleRemoved(t)}ngOnDestroy(){let e=this.styleNodesInDOM;e&&(e.forEach(t=>t.remove()),e.clear());for(let t of this.getAllStyles())this.onStyleRemoved(t);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(let t of this.getAllStyles())this.addStyleToHost(e,t)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(let t of this.hostNodes)this.addStyleToHost(t,e)}onStyleRemoved(e){let t=this.styleRef;t.get(e)?.elements?.forEach(s=>s.remove()),t.delete(e)}collectServerRenderedStyles(){let e=this.doc.head?.querySelectorAll(`style[${Ir}="${this.appId}"]`);if(e?.length){let t=new Map;return e.forEach(s=>{s.textContent!=null&&t.set(s.textContent,s)}),t}return null}changeUsageCount(e,t){let s=this.styleRef;if(s.has(e)){let i=s.get(e);return i.usage+=t,i.usage}return s.set(e,{usage:t,elements:[]}),t}getStyleElement(e,t){let s=this.styleNodesInDOM,i=s?.get(t);if(i?.parentNode===e)return s.delete(t),i.removeAttribute(Ir),i;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=t,this.platformIsServer&&o.setAttribute(Ir,this.appId),e.appendChild(o),o}}addStyleToHost(e,t){let s=this.getStyleElement(e,t),i=this.styleRef,o=i.get(t)?.elements;o?o.push(s):i.set(t,{elements:[s],usage:1})}resetHostNodes(){let e=this.hostNodes;e.clear(),e.add(this.doc.head)}static{this.\u0275fac=function(t){return new(t||r)(w(L),w(bt),w(dr,8),w(ge))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),kr={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Pr=/%COMP%/g,Es="%COMP%",Ji=`_nghost-${Es}`,Ki=`_ngcontent-${Es}`,Qi=!0,Zi=new _("",{providedIn:"root",factory:()=>Qi});function Xi(r){return Ki.replace(Pr,r)}function Yi(r){return Ji.replace(Pr,r)}function As(r,n){return n.map(e=>e.replace(Pr,r))}var Ts=(()=>{class r{constructor(e,t,s,i,o,c,a,l=null){this.eventManager=e,this.sharedStylesHost=t,this.appId=s,this.removeStylesOnCompDestroy=i,this.doc=o,this.platformId=c,this.ngZone=a,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=At(c),this.defaultRenderer=new Ke(e,o,a,this.platformIsServer)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;this.platformIsServer&&t.encapsulation===Fe.ShadowDom&&(t=U(m({},t),{encapsulation:Fe.Emulated}));let s=this.getOrCreateRenderer(e,t);return s instanceof Ut?s.applyToHost(e):s instanceof Qe&&s.applyStyles(),s}getOrCreateRenderer(e,t){let s=this.rendererByCompId,i=s.get(t.id);if(!i){let o=this.doc,c=this.ngZone,a=this.eventManager,l=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,u=this.platformIsServer;switch(t.encapsulation){case Fe.Emulated:i=new Ut(a,l,t,this.appId,h,o,c,u);break;case Fe.ShadowDom:return new xr(a,l,e,t,o,c,this.nonce,u);default:i=new Qe(a,l,t,h,o,c,u);break}s.set(t.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(t){return new(t||r)(w(Is),w(ks),w(bt),w(Zi),w(L),w(ge),w(G),w(dr))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),Ke=class{constructor(n,e,t,s){this.eventManager=n,this.doc=e,this.ngZone=t,this.platformIsServer=s,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(n,e){return e?this.doc.createElementNS(kr[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){(Rs(n)?n.content:n).appendChild(e)}insertBefore(n,e,t){n&&(Rs(n)?n.content:n).insertBefore(e,t)}removeChild(n,e){e.remove()}selectRootElement(n,e){let t=typeof n=="string"?this.doc.querySelector(n):n;if(!t)throw new A(-5104,!1);return e||(t.textContent=""),t}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,t,s){if(s){e=s+":"+e;let i=kr[s];i?n.setAttributeNS(i,e,t):n.setAttribute(e,t)}else n.setAttribute(e,t)}removeAttribute(n,e,t){if(t){let s=kr[t];s?n.removeAttributeNS(s,e):n.removeAttribute(`${t}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,t,s){s&(Be.DashCase|Be.Important)?n.style.setProperty(e,t,s&Be.Important?"important":""):n.style[e]=t}removeStyle(n,e,t){t&Be.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,t){n!=null&&(n[e]=t)}setValue(n,e){n.nodeValue=e}listen(n,e,t){if(typeof n=="string"&&(n=It().getGlobalEventTarget(this.doc,n),!n))throw new Error(`Unsupported event target ${n} for event ${e}`);return this.eventManager.addEventListener(n,e,this.decoratePreventDefault(t))}decoratePreventDefault(n){return e=>{if(e==="__ngUnwrap__")return n;(this.platformIsServer?this.ngZone.runGuarded(()=>n(e)):n(e))===!1&&e.preventDefault()}}};function Rs(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var xr=class extends Ke{constructor(n,e,t,s,i,o,c,a){super(n,i,o,a),this.sharedStylesHost=e,this.hostEl=t,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=As(s.id,s.styles);for(let h of l){let u=document.createElement("style");c&&u.setAttribute("nonce",c),u.textContent=h,this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,t){return super.insertBefore(this.nodeOrShadowRoot(n),e,t)}removeChild(n,e){return super.removeChild(null,e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Qe=class extends Ke{constructor(n,e,t,s,i,o,c,a){super(n,i,o,c),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=s,this.styles=a?As(a,t.styles):t.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Ut=class extends Qe{constructor(n,e,t,s,i,o,c,a){let l=s+"-"+t.id;super(n,e,t,i,o,c,a,l),this.contentAttr=Xi(l),this.hostAttr=Yi(l)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){let t=super.createElement(n,e);return super.setAttribute(t,this.contentAttr,""),t}},eo=(()=>{class r extends Ot{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,s){return e.addEventListener(t,s,!1),()=>this.removeEventListener(e,t,s)}removeEventListener(e,t,s){return e.removeEventListener(t,s)}static{this.\u0275fac=function(t){return new(t||r)(w(L))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),Cs=["alt","control","meta","shift"],to={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ro={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},no=(()=>{class r extends Ot{constructor(e){super(e)}supports(e){return r.parseEventName(e)!=null}addEventListener(e,t,s){let i=r.parseEventName(t),o=r.eventCallback(i.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>It().onAndCancel(e,i.domEventName,o))}static parseEventName(e){let t=e.toLowerCase().split("."),s=t.shift();if(t.length===0||!(s==="keydown"||s==="keyup"))return null;let i=r._normalizeKey(t.pop()),o="",c=t.indexOf("code");if(c>-1&&(t.splice(c,1),o="code."),Cs.forEach(l=>{let h=t.indexOf(l);h>-1&&(t.splice(h,1),o+=l+".")}),o+=i,t.length!=0||i.length===0)return null;let a={};return a.domEventName=s,a.fullKey=o,a}static matchEventFullKeyCode(e,t){let s=to[e.key]||e.key,i="";return t.indexOf("code.")>-1&&(s=e.code,i="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Cs.forEach(o=>{if(o!==s){let c=ro[o];c(e)&&(i+=o+".")}}),i+=s,i===t)}static eventCallback(e,t,s){return i=>{r.matchEventFullKeyCode(i,e)&&s.runGuarded(()=>t(i))}}static _normalizeKey(e){return e==="esc"?"escape":e}static{this.\u0275fac=function(t){return new(t||r)(w(L))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})();function Jc(r,n){return as(m({rootComponent:r},so(n)))}function so(r){return{appProviders:[..._s,...r?.providers??[]],platformProviders:co}}function io(){Ar.makeCurrent()}function oo(){return new hr}function ao(){return Bn(document),document}var co=[{provide:ge,useValue:us},{provide:Vn,useValue:io,multi:!0},{provide:L,useFactory:ao,deps:[]}];var lo=new _(""),uo=[{provide:Tt,useClass:_r,deps:[]},{provide:ss,useClass:Rt,deps:[G,fr,Tt]},{provide:Rt,useClass:Rt,deps:[G,fr,Tt]}],_s=[{provide:$n,useValue:"root"},{provide:hr,useFactory:oo,deps:[]},{provide:Mr,useClass:eo,multi:!0,deps:[L,G,ge]},{provide:Mr,useClass:no,multi:!0,deps:[L]},Ts,ks,Is,{provide:Xn,useExisting:Ts},{provide:_t,useClass:Gi,deps:[]},[]],Kc=(()=>{class r{constructor(e){}static withServerTransition(e){return{ngModule:r,providers:[{provide:bt,useValue:e.appId}]}}static{this.\u0275fac=function(t){return new(t||r)(w(lo,12))}}static{this.\u0275mod=$e({type:r})}static{this.\u0275inj=je({providers:[..._s,...uo],imports:[vr,os]})}}return r})();var Ms=(()=>{class r{constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static{this.\u0275fac=function(t){return new(t||r)(w(L))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var ho=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:function(t){let s=null;return t?s=new(t||r):s=w(fo),s},providedIn:"root"})}}return r})(),fo=(()=>{class r extends ho{constructor(e){super(),this._doc=e}sanitize(e,t){if(t==null)return null;switch(e){case me.NONE:return t;case me.HTML:return Ie(t,"HTML")?Ce(t):Zn(this._doc,String(t)).toString();case me.STYLE:return Ie(t,"Style")?Ce(t):t;case me.SCRIPT:if(Ie(t,"Script"))return Ce(t);throw new A(5200,!1);case me.URL:return Ie(t,"URL")?Ce(t):Qn(String(t));case me.RESOURCE_URL:if(Ie(t,"ResourceURL"))return Ce(t);throw new A(5201,!1);default:throw new A(5202,!1)}}bypassSecurityTrustHtml(e){return qn(e)}bypassSecurityTrustStyle(e){return Wn(e)}bypassSecurityTrustScript(e){return Gn(e)}bypassSecurityTrustUrl(e){return Jn(e)}bypassSecurityTrustResourceUrl(e){return Kn(e)}static{this.\u0275fac=function(t){return new(t||r)(w(L))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var S="primary",ft=Symbol("RouteTitle"),Lr=class{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){let e=this.params[n];return Array.isArray(e)?e[0]:e}return null}getAll(n){if(this.has(n)){let e=this.params[n];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function xe(r){return new Lr(r)}function go(r,n,e){let t=e.path.split("/");if(t.length>r.length||e.pathMatch==="full"&&(n.hasChildren()||t.length<r.length))return null;let s={};for(let i=0;i<t.length;i++){let o=t[i],c=r[i];if(o[0]===":")s[o.substring(1)]=c;else if(o!==c.path)return null}return{consumed:r.slice(0,t.length),posParams:s}}function mo(r,n){if(r.length!==n.length)return!1;for(let e=0;e<r.length;++e)if(!Y(r[e],n[e]))return!1;return!0}function Y(r,n){let e=r?jr(r):void 0,t=n?jr(n):void 0;if(!e||!t||e.length!=t.length)return!1;let s;for(let i=0;i<e.length;i++)if(s=e[i],!js(r[s],n[s]))return!1;return!0}function jr(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function js(r,n){if(Array.isArray(r)&&Array.isArray(n)){if(r.length!==n.length)return!1;let e=[...r].sort(),t=[...n].sort();return e.every((s,i)=>t[i]===s)}else return r===n}function Fs(r){return r.length>0?r[r.length-1]:null}function de(r){return In(r)?r:is(r)?N(Promise.resolve(r)):p(r)}var vo={exact:zs,subset:Hs},$s={exact:yo,subset:wo,ignored:()=>!0};function xs(r,n,e){return vo[e.paths](r.root,n.root,e.matrixParams)&&$s[e.queryParams](r.queryParams,n.queryParams)&&!(e.fragment==="exact"&&r.fragment!==n.fragment)}function yo(r,n){return Y(r,n)}function zs(r,n,e){if(!ye(r.segments,n.segments)||!jt(r.segments,n.segments,e)||r.numberOfChildren!==n.numberOfChildren)return!1;for(let t in n.children)if(!r.children[t]||!zs(r.children[t],n.children[t],e))return!1;return!0}function wo(r,n){return Object.keys(n).length<=Object.keys(r).length&&Object.keys(n).every(e=>js(r[e],n[e]))}function Hs(r,n,e){return Bs(r,n,n.segments,e)}function Bs(r,n,e,t){if(r.segments.length>e.length){let s=r.segments.slice(0,e.length);return!(!ye(s,e)||n.hasChildren()||!jt(s,e,t))}else if(r.segments.length===e.length){if(!ye(r.segments,e)||!jt(r.segments,e,t))return!1;for(let s in n.children)if(!r.children[s]||!Hs(r.children[s],n.children[s],t))return!1;return!0}else{let s=e.slice(0,r.segments.length),i=e.slice(r.segments.length);return!ye(r.segments,s)||!jt(r.segments,s,t)||!r.children[S]?!1:Bs(r.children[S],n,i,t)}}function jt(r,n,e){return n.every((t,s)=>$s[e](r[s].parameters,t.parameters))}var se=class{constructor(n=new I([],{}),e={},t=null){this.root=n,this.queryParams=e,this.fragment=t}get queryParamMap(){return this._queryParamMap??=xe(this.queryParams),this._queryParamMap}toString(){return To.serialize(this)}},I=class{constructor(n,e){this.segments=n,this.children=e,this.parent=null,Object.values(e).forEach(t=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ft(this)}},ve=class{constructor(n,e){this.path=n,this.parameters=e}get parameterMap(){return this._parameterMap??=xe(this.parameters),this._parameterMap}toString(){return qs(this)}};function bo(r,n){return ye(r,n)&&r.every((e,t)=>Y(e.parameters,n[t].parameters))}function ye(r,n){return r.length!==n.length?!1:r.every((e,t)=>e.path===n[t].path)}function So(r,n){let e=[];return Object.entries(r.children).forEach(([t,s])=>{t===S&&(e=e.concat(n(s,t)))}),Object.entries(r.children).forEach(([t,s])=>{t!==S&&(e=e.concat(n(s,t)))}),e}var hn=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:()=>new nt,providedIn:"root"})}}return r})(),nt=class{parse(n){let e=new $r(n);return new se(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(n){let e=`/${Ze(n.root,!0)}`,t=Io(n.queryParams),s=typeof n.fragment=="string"?`#${Ro(n.fragment)}`:"";return`${e}${t}${s}`}},To=new nt;function Ft(r){return r.segments.map(n=>qs(n)).join("/")}function Ze(r,n){if(!r.hasChildren())return Ft(r);if(n){let e=r.children[S]?Ze(r.children[S],!1):"",t=[];return Object.entries(r.children).forEach(([s,i])=>{s!==S&&t.push(`${s}:${Ze(i,!1)}`)}),t.length>0?`${e}(${t.join("//")})`:e}else{let e=So(r,(t,s)=>s===S?[Ze(r.children[S],!1)]:[`${s}:${Ze(t,!1)}`]);return Object.keys(r.children).length===1&&r.children[S]!=null?`${Ft(r)}/${e[0]}`:`${Ft(r)}/(${e.join("//")})`}}function Vs(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Nt(r){return Vs(r).replace(/%3B/gi,";")}function Ro(r){return encodeURI(r)}function Fr(r){return Vs(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $t(r){return decodeURIComponent(r)}function Ps(r){return $t(r.replace(/\+/g,"%20"))}function qs(r){return`${Fr(r.path)}${Co(r.parameters)}`}function Co(r){return Object.entries(r).map(([n,e])=>`;${Fr(n)}=${Fr(e)}`).join("")}function Io(r){let n=Object.entries(r).map(([e,t])=>Array.isArray(t)?t.map(s=>`${Nt(e)}=${Nt(s)}`).join("&"):`${Nt(e)}=${Nt(t)}`).filter(e=>e);return n.length?`?${n.join("&")}`:""}var ko=/^[^\/()?;#]+/;function Dr(r){let n=r.match(ko);return n?n[0]:""}var Eo=/^[^\/()?;=#]+/;function Ao(r){let n=r.match(Eo);return n?n[0]:""}var _o=/^[^=?&#]+/;function Mo(r){let n=r.match(_o);return n?n[0]:""}var xo=/^[^&#]+/;function Po(r){let n=r.match(xo);return n?n[0]:""}var $r=class{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new I([],{}):new I([],this.parseChildren())}parseQueryParams(){let n={};if(this.consumeOptional("?"))do this.parseQueryParam(n);while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let t={};return this.peekStartsWith("(")&&(t=this.parseParens(!1)),(n.length>0||Object.keys(e).length>0)&&(t[S]=new I(n,e)),t}parseSegment(){let n=Dr(this.remaining);if(n===""&&this.peekStartsWith(";"))throw new A(4009,!1);return this.capture(n),new ve($t(n),this.parseMatrixParams())}parseMatrixParams(){let n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){let e=Ao(this.remaining);if(!e)return;this.capture(e);let t="";if(this.consumeOptional("=")){let s=Dr(this.remaining);s&&(t=s,this.capture(t))}n[$t(e)]=$t(t)}parseQueryParam(n){let e=Mo(this.remaining);if(!e)return;this.capture(e);let t="";if(this.consumeOptional("=")){let o=Po(this.remaining);o&&(t=o,this.capture(t))}let s=Ps(e),i=Ps(t);if(n.hasOwnProperty(s)){let o=n[s];Array.isArray(o)||(o=[o],n[s]=o),o.push(i)}else n[s]=i}parseParens(n){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let t=Dr(this.remaining),s=this.remaining[t.length];if(s!=="/"&&s!==")"&&s!==";")throw new A(4010,!1);let i;t.indexOf(":")>-1?(i=t.slice(0,t.indexOf(":")),this.capture(i),this.capture(":")):n&&(i=S);let o=this.parseChildren();e[i]=Object.keys(o).length===1?o[S]:new I([],o),this.consumeOptional("//")}return e}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return this.peekStartsWith(n)?(this.remaining=this.remaining.substring(n.length),!0):!1}capture(n){if(!this.consumeOptional(n))throw new A(4011,!1)}};function Ws(r){return r.segments.length>0?new I([],{[S]:r}):r}function Gs(r){let n={};for(let[t,s]of Object.entries(r.children)){let i=Gs(s);if(t===S&&i.segments.length===0&&i.hasChildren())for(let[o,c]of Object.entries(i.children))n[o]=c;else(i.segments.length>0||i.hasChildren())&&(n[t]=i)}let e=new I(r.segments,n);return Do(e)}function Do(r){if(r.numberOfChildren===1&&r.children[S]){let n=r.children[S];return new I(r.segments.concat(n.segments),n.children)}return r}function st(r){return r instanceof se}function Oo(r,n,e=null,t=null){let s=Js(r);return Ks(s,n,e,t)}function Js(r){let n;function e(i){let o={};for(let a of i.children){let l=e(a);o[a.outlet]=l}let c=new I(i.url,o);return i===r&&(n=c),c}let t=e(r.root),s=Ws(t);return n??s}function Ks(r,n,e,t){let s=r;for(;s.parent;)s=s.parent;if(n.length===0)return Or(s,s,s,e,t);let i=Uo(n);if(i.toRoot())return Or(s,s,new I([],{}),e,t);let o=No(i,s,r),c=o.processChildren?et(o.segmentGroup,o.index,i.commands):Zs(o.segmentGroup,o.index,i.commands);return Or(s,o.segmentGroup,c,e,t)}function zt(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function it(r){return typeof r=="object"&&r!=null&&r.outlets}function Or(r,n,e,t,s){let i={};t&&Object.entries(t).forEach(([a,l])=>{i[a]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let o;r===n?o=e:o=Qs(r,n,e);let c=Ws(Gs(o));return new se(c,i,s)}function Qs(r,n,e){let t={};return Object.entries(r.children).forEach(([s,i])=>{i===n?t[s]=e:t[s]=Qs(i,n,e)}),new I(r.segments,t)}var Ht=class{constructor(n,e,t){if(this.isAbsolute=n,this.numberOfDoubleDots=e,this.commands=t,n&&t.length>0&&zt(t[0]))throw new A(4003,!1);let s=t.find(it);if(s&&s!==Fs(t))throw new A(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Uo(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new Ht(!0,0,r);let n=0,e=!1,t=r.reduce((s,i,o)=>{if(typeof i=="object"&&i!=null){if(i.outlets){let c={};return Object.entries(i.outlets).forEach(([a,l])=>{c[a]=typeof l=="string"?l.split("/"):l}),[...s,{outlets:c}]}if(i.segmentPath)return[...s,i.segmentPath]}return typeof i!="string"?[...s,i]:o===0?(i.split("/").forEach((c,a)=>{a==0&&c==="."||(a==0&&c===""?e=!0:c===".."?n++:c!=""&&s.push(c))}),s):[...s,i]},[]);return new Ht(e,n,t)}var Ae=class{constructor(n,e,t){this.segmentGroup=n,this.processChildren=e,this.index=t}};function No(r,n,e){if(r.isAbsolute)return new Ae(n,!0,0);if(!e)return new Ae(n,!1,NaN);if(e.parent===null)return new Ae(e,!0,0);let t=zt(r.commands[0])?0:1,s=e.segments.length-1+t;return Lo(e,s,r.numberOfDoubleDots)}function Lo(r,n,e){let t=r,s=n,i=e;for(;i>s;){if(i-=s,t=t.parent,!t)throw new A(4005,!1);s=t.segments.length}return new Ae(t,!1,s-i)}function jo(r){return it(r[0])?r[0].outlets:{[S]:r}}function Zs(r,n,e){if(r??=new I([],{}),r.segments.length===0&&r.hasChildren())return et(r,n,e);let t=Fo(r,n,e),s=e.slice(t.commandIndex);if(t.match&&t.pathIndex<r.segments.length){let i=new I(r.segments.slice(0,t.pathIndex),{});return i.children[S]=new I(r.segments.slice(t.pathIndex),r.children),et(i,0,s)}else return t.match&&s.length===0?new I(r.segments,{}):t.match&&!r.hasChildren()?zr(r,n,e):t.match?et(r,0,s):zr(r,n,e)}function et(r,n,e){if(e.length===0)return new I(r.segments,{});{let t=jo(e),s={};if(Object.keys(t).some(i=>i!==S)&&r.children[S]&&r.numberOfChildren===1&&r.children[S].segments.length===0){let i=et(r.children[S],n,e);return new I(r.segments,i.children)}return Object.entries(t).forEach(([i,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(s[i]=Zs(r.children[i],n,o))}),Object.entries(r.children).forEach(([i,o])=>{t[i]===void 0&&(s[i]=o)}),new I(r.segments,s)}}function Fo(r,n,e){let t=0,s=n,i={match:!1,pathIndex:0,commandIndex:0};for(;s<r.segments.length;){if(t>=e.length)return i;let o=r.segments[s],c=e[t];if(it(c))break;let a=`${c}`,l=t<e.length-1?e[t+1]:null;if(s>0&&a===void 0)break;if(a&&l&&typeof l=="object"&&l.outlets===void 0){if(!Os(a,l,o))return i;t+=2}else{if(!Os(a,{},o))return i;t++}s++}return{match:!0,pathIndex:s,commandIndex:t}}function zr(r,n,e){let t=r.segments.slice(0,n),s=0;for(;s<e.length;){let i=e[s];if(it(i)){let a=$o(i.outlets);return new I(t,a)}if(s===0&&zt(e[0])){let a=r.segments[n];t.push(new ve(a.path,Ds(e[0]))),s++;continue}let o=it(i)?i.outlets[S]:`${i}`,c=s<e.length-1?e[s+1]:null;o&&c&&zt(c)?(t.push(new ve(o,Ds(c))),s+=2):(t.push(new ve(o,{})),s++)}return new I(t,{})}function $o(r){let n={};return Object.entries(r).forEach(([e,t])=>{typeof t=="string"&&(t=[t]),t!==null&&(n[e]=zr(new I([],{}),0,t))}),n}function Ds(r){let n={};return Object.entries(r).forEach(([e,t])=>n[e]=`${t}`),n}function Os(r,n,e){return r==e.path&&Y(n,e.parameters)}var tt="imperative",O=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(O||{}),J=class{constructor(n,e){this.id=n,this.url=e}},ot=class extends J{constructor(n,e,t="imperative",s=null){super(n,e),this.type=O.NavigationStart,this.navigationTrigger=t,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},we=class extends J{constructor(n,e,t){super(n,e),this.urlAfterRedirects=t,this.type=O.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},B=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}(B||{}),Hr=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}(Hr||{}),ne=class extends J{constructor(n,e,t,s){super(n,e),this.reason=t,this.code=s,this.type=O.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},be=class extends J{constructor(n,e,t,s){super(n,e),this.reason=t,this.code=s,this.type=O.NavigationSkipped}},at=class extends J{constructor(n,e,t,s){super(n,e),this.error=t,this.target=s,this.type=O.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Bt=class extends J{constructor(n,e,t,s){super(n,e),this.urlAfterRedirects=t,this.state=s,this.type=O.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Br=class extends J{constructor(n,e,t,s){super(n,e),this.urlAfterRedirects=t,this.state=s,this.type=O.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Vr=class extends J{constructor(n,e,t,s,i){super(n,e),this.urlAfterRedirects=t,this.state=s,this.shouldActivate=i,this.type=O.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},qr=class extends J{constructor(n,e,t,s){super(n,e),this.urlAfterRedirects=t,this.state=s,this.type=O.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Wr=class extends J{constructor(n,e,t,s){super(n,e),this.urlAfterRedirects=t,this.state=s,this.type=O.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Gr=class{constructor(n){this.route=n,this.type=O.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Jr=class{constructor(n){this.route=n,this.type=O.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Kr=class{constructor(n){this.snapshot=n,this.type=O.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Qr=class{constructor(n){this.snapshot=n,this.type=O.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Zr=class{constructor(n){this.snapshot=n,this.type=O.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xr=class{constructor(n){this.snapshot=n,this.type=O.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var ct=class{},Pe=class{constructor(n,e){this.url=n,this.navigationBehaviorOptions=e}};function zo(r,n){return r.providers&&!r._injector&&(r._injector=ts(r.providers,n,`Route: ${r.path}`)),r._injector??n}function Q(r){return r.outlet||S}function Ho(r,n){let e=r.filter(t=>Q(t)===n);return e.push(...r.filter(t=>Q(t)!==n)),e}function pt(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let n=r.parent;n;n=n.parent){let e=n.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var Yr=class{get injector(){return pt(this.route?.snapshot)??this.rootInjector}set injector(n){}constructor(n){this.rootInjector=n,this.outlet=null,this.route=null,this.children=new Qt(this.rootInjector),this.attachRef=null}},Qt=(()=>{class r{constructor(e){this.rootInjector=e,this.contexts=new Map}onChildOutletCreated(e,t){let s=this.getOrCreateContext(e);s.outlet=t,this.contexts.set(e,s)}onChildOutletDestroyed(e){let t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new Yr(this.rootInjector),this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}static{this.\u0275fac=function(t){return new(t||r)(w(Re))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),Vt=class{constructor(n){this._root=n}get root(){return this._root.value}parent(n){let e=this.pathFromRoot(n);return e.length>1?e[e.length-2]:null}children(n){let e=en(n,this._root);return e?e.children.map(t=>t.value):[]}firstChild(n){let e=en(n,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(n){let e=tn(n,this._root);return e.length<2?[]:e[e.length-2].children.map(s=>s.value).filter(s=>s!==n)}pathFromRoot(n){return tn(n,this._root).map(e=>e.value)}};function en(r,n){if(r===n.value)return n;for(let e of n.children){let t=en(r,e);if(t)return t}return null}function tn(r,n){if(r===n.value)return[n];for(let e of n.children){let t=tn(r,e);if(t.length)return t.unshift(n),t}return[]}var H=class{constructor(n,e){this.value=n,this.children=e}toString(){return`TreeNode(${this.value})`}};function Ee(r){let n={};return r&&r.children.forEach(e=>n[e.value.outlet]=e),n}var qt=class extends Vt{constructor(n,e){super(n),this.snapshot=e,dn(this,n)}toString(){return this.snapshot.toString()}};function Xs(r){let n=Bo(r),e=new V([new ve("",{})]),t=new V({}),s=new V({}),i=new V({}),o=new V(""),c=new De(e,t,i,o,s,S,r,n.root);return c.snapshot=n.root,new qt(new H(c,[]),n)}function Bo(r){let n={},e={},t={},s="",i=new _e([],n,t,s,e,S,r,null,{});return new Gt("",new H(i,[]))}var De=class{constructor(n,e,t,s,i,o,c,a){this.urlSubject=n,this.paramsSubject=e,this.queryParamsSubject=t,this.fragmentSubject=s,this.dataSubject=i,this.outlet=o,this.component=c,this._futureSnapshot=a,this.title=this.dataSubject?.pipe(C(l=>l[ft]))??p(void 0),this.url=n,this.params=e,this.queryParams=t,this.fragment=s,this.data=i}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(C(n=>xe(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(C(n=>xe(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Wt(r,n,e="emptyOnly"){let t,{routeConfig:s}=r;return n!==null&&(e==="always"||s?.path===""||!n.component&&!n.routeConfig?.loadComponent)?t={params:m(m({},n.params),r.params),data:m(m({},n.data),r.data),resolve:m(m(m(m({},r.data),n.data),s?.data),r._resolvedData)}:t={params:m({},r.params),data:m({},r.data),resolve:m(m({},r.data),r._resolvedData??{})},s&&ei(s)&&(t.resolve[ft]=s.title),t}var _e=class{get title(){return this.data?.[ft]}constructor(n,e,t,s,i,o,c,a,l){this.url=n,this.params=e,this.queryParams=t,this.fragment=s,this.data=i,this.outlet=o,this.component=c,this.routeConfig=a,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=xe(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=xe(this.queryParams),this._queryParamMap}toString(){let n=this.url.map(t=>t.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${n}', path:'${e}')`}},Gt=class extends Vt{constructor(n,e){super(e),this.url=n,dn(this,e)}toString(){return Ys(this._root)}};function dn(r,n){n.value._routerState=r,n.children.forEach(e=>dn(r,e))}function Ys(r){let n=r.children.length>0?` { ${r.children.map(Ys).join(", ")} } `:"";return`${r.value}${n}`}function Ur(r){if(r.snapshot){let n=r.snapshot,e=r._futureSnapshot;r.snapshot=e,Y(n.queryParams,e.queryParams)||r.queryParamsSubject.next(e.queryParams),n.fragment!==e.fragment&&r.fragmentSubject.next(e.fragment),Y(n.params,e.params)||r.paramsSubject.next(e.params),mo(n.url,e.url)||r.urlSubject.next(e.url),Y(n.data,e.data)||r.dataSubject.next(e.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function rn(r,n){let e=Y(r.params,n.params)&&bo(r.url,n.url),t=!r.parent!=!n.parent;return e&&!t&&(!r.parent||rn(r.parent,n.parent))}function ei(r){return typeof r.title=="string"||r.title===null}var Vo=(()=>{class r{constructor(){this.activated=null,this._activatedRoute=null,this.name=S,this.activateEvents=new He,this.deactivateEvents=new He,this.attachEvents=new He,this.detachEvents=new He,this.parentContexts=y(Qt),this.location=y(Yn),this.changeDetector=y(mr),this.inputBinder=y(fn,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(e){if(e.name){let{firstChange:t,previousValue:s}=e.name;if(t)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new A(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new A(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new A(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,t){if(this.isActivated)throw new A(4013,!1);this._activatedRoute=e;let s=this.location,o=e.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,a=new nn(e,c,s.injector);this.activated=s.createComponent(o,{index:s.length,injector:a,environmentInjector:t}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275dir=Fn({type:r,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[zn]})}}return r})(),nn=class r{__ngOutletInjector(n){return new r(this.route,this.childContexts,n)}constructor(n,e,t){this.route=n,this.childContexts=e,this.parent=t}get(n,e){return n===De?this.route:n===Qt?this.childContexts:this.parent.get(n,e)}},fn=new _("");function qo(r,n,e){let t=lt(r,n._root,e?e._root:void 0);return new qt(t,n)}function lt(r,n,e){if(e&&r.shouldReuseRoute(n.value,e.value.snapshot)){let t=e.value;t._futureSnapshot=n.value;let s=Wo(r,n,e);return new H(t,s)}else{if(r.shouldAttach(n.value)){let i=r.retrieve(n.value);if(i!==null){let o=i.route;return o.value._futureSnapshot=n.value,o.children=n.children.map(c=>lt(r,c)),o}}let t=Go(n.value),s=n.children.map(i=>lt(r,i));return new H(t,s)}}function Wo(r,n,e){return n.children.map(t=>{for(let s of e.children)if(r.shouldReuseRoute(t.value,s.value.snapshot))return lt(r,t,s);return lt(r,t)})}function Go(r){return new De(new V(r.url),new V(r.params),new V(r.queryParams),new V(r.fragment),new V(r.data),r.outlet,r.component,r)}var ut=class{constructor(n,e){this.redirectTo=n,this.navigationBehaviorOptions=e}},ti="ngNavigationCancelingError";function Jt(r,n){let{redirectTo:e,navigationBehaviorOptions:t}=st(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,s=ri(!1,B.Redirect);return s.url=e,s.navigationBehaviorOptions=t,s}function ri(r,n){let e=new Error(`NavigationCancelingError: ${r||""}`);return e[ti]=!0,e.cancellationCode=n,e}function Jo(r){return ni(r)&&st(r.url)}function ni(r){return!!r&&r[ti]}var Ko=(r,n,e,t)=>C(s=>(new sn(n,s.targetRouterState,s.currentRouterState,e,t).activate(r),s)),sn=class{constructor(n,e,t,s,i){this.routeReuseStrategy=n,this.futureState=e,this.currState=t,this.forwardEvent=s,this.inputBindingEnabled=i}activate(n){let e=this.futureState._root,t=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,t,n),Ur(this.futureState.root),this.activateChildRoutes(e,t,n)}deactivateChildRoutes(n,e,t){let s=Ee(e);n.children.forEach(i=>{let o=i.value.outlet;this.deactivateRoutes(i,s[o],t),delete s[o]}),Object.values(s).forEach(i=>{this.deactivateRouteAndItsChildren(i,t)})}deactivateRoutes(n,e,t){let s=n.value,i=e?e.value:null;if(s===i)if(s.component){let o=t.getContext(s.outlet);o&&this.deactivateChildRoutes(n,e,o.children)}else this.deactivateChildRoutes(n,e,t);else i&&this.deactivateRouteAndItsChildren(e,t)}deactivateRouteAndItsChildren(n,e){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,e):this.deactivateRouteAndOutlet(n,e)}detachAndStoreRouteSubtree(n,e){let t=e.getContext(n.value.outlet),s=t&&n.value.component?t.children:e,i=Ee(n);for(let o of Object.values(i))this.deactivateRouteAndItsChildren(o,s);if(t&&t.outlet){let o=t.outlet.detach(),c=t.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:o,route:n,contexts:c})}}deactivateRouteAndOutlet(n,e){let t=e.getContext(n.value.outlet),s=t&&n.value.component?t.children:e,i=Ee(n);for(let o of Object.values(i))this.deactivateRouteAndItsChildren(o,s);t&&(t.outlet&&(t.outlet.deactivate(),t.children.onOutletDeactivated()),t.attachRef=null,t.route=null)}activateChildRoutes(n,e,t){let s=Ee(e);n.children.forEach(i=>{this.activateRoutes(i,s[i.value.outlet],t),this.forwardEvent(new Xr(i.value.snapshot))}),n.children.length&&this.forwardEvent(new Qr(n.value.snapshot))}activateRoutes(n,e,t){let s=n.value,i=e?e.value:null;if(Ur(s),s===i)if(s.component){let o=t.getOrCreateContext(s.outlet);this.activateChildRoutes(n,e,o.children)}else this.activateChildRoutes(n,e,t);else if(s.component){let o=t.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){let c=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),o.children.onOutletReAttached(c.contexts),o.attachRef=c.componentRef,o.route=c.route.value,o.outlet&&o.outlet.attach(c.componentRef,c.route.value),Ur(c.route.value),this.activateChildRoutes(n,null,o.children)}else o.attachRef=null,o.route=s,o.outlet&&o.outlet.activateWith(s,o.injector),this.activateChildRoutes(n,null,o.children)}else this.activateChildRoutes(n,null,t)}},Kt=class{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}},Me=class{constructor(n,e){this.component=n,this.route=e}};function Qo(r,n,e){let t=r._root,s=n?n._root:null;return Xe(t,s,e,[t.value])}function Zo(r){let n=r.routeConfig?r.routeConfig.canActivateChild:null;return!n||n.length===0?null:{node:r,guards:n}}function Ue(r,n){let e=Symbol(),t=n.get(r,e);return t===e?typeof r=="function"&&!Ln(r)?r:n.get(r):t}function Xe(r,n,e,t,s={canDeactivateChecks:[],canActivateChecks:[]}){let i=Ee(n);return r.children.forEach(o=>{Xo(o,i[o.value.outlet],e,t.concat([o.value]),s),delete i[o.value.outlet]}),Object.entries(i).forEach(([o,c])=>rt(c,e.getContext(o),s)),s}function Xo(r,n,e,t,s={canDeactivateChecks:[],canActivateChecks:[]}){let i=r.value,o=n?n.value:null,c=e?e.getContext(r.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){let a=Yo(o,i,i.routeConfig.runGuardsAndResolvers);a?s.canActivateChecks.push(new Kt(t)):(i.data=o.data,i._resolvedData=o._resolvedData),i.component?Xe(r,n,c?c.children:null,t,s):Xe(r,n,e,t,s),a&&c&&c.outlet&&c.outlet.isActivated&&s.canDeactivateChecks.push(new Me(c.outlet.component,o))}else o&&rt(n,c,s),s.canActivateChecks.push(new Kt(t)),i.component?Xe(r,null,c?c.children:null,t,s):Xe(r,null,e,t,s);return s}function Yo(r,n,e){if(typeof e=="function")return e(r,n);switch(e){case"pathParamsChange":return!ye(r.url,n.url);case"pathParamsOrQueryParamsChange":return!ye(r.url,n.url)||!Y(r.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!rn(r,n)||!Y(r.queryParams,n.queryParams);case"paramsChange":default:return!rn(r,n)}}function rt(r,n,e){let t=Ee(r),s=r.value;Object.entries(t).forEach(([i,o])=>{s.component?n?rt(o,n.children.getContext(i),e):rt(o,null,e):rt(o,n,e)}),s.component?n&&n.outlet&&n.outlet.isActivated?e.canDeactivateChecks.push(new Me(n.outlet.component,s)):e.canDeactivateChecks.push(new Me(null,s)):e.canDeactivateChecks.push(new Me(null,s))}function gt(r){return typeof r=="function"}function ea(r){return typeof r=="boolean"}function ta(r){return r&&gt(r.canLoad)}function ra(r){return r&&gt(r.canActivate)}function na(r){return r&&gt(r.canActivateChild)}function sa(r){return r&&gt(r.canDeactivate)}function ia(r){return r&&gt(r.canMatch)}function si(r){return r instanceof kn||r?.name==="EmptyError"}var Lt=Symbol("INITIAL_VALUE");function Oe(){return $(r=>Le(r.map(n=>n.pipe(ce(1),Un(Lt)))).pipe(C(n=>{for(let e of n)if(e!==!0){if(e===Lt)return Lt;if(e===!1||oa(e))return e}return!0}),P(n=>n!==Lt),ce(1)))}function oa(r){return st(r)||r instanceof ut}function aa(r,n){return F(e=>{let{targetSnapshot:t,currentSnapshot:s,guards:{canActivateChecks:i,canDeactivateChecks:o}}=e;return o.length===0&&i.length===0?p(U(m({},e),{guardsResult:!0})):ca(o,t,s,r).pipe(F(c=>c&&ea(c)?la(t,i,r,n):p(c)),C(c=>U(m({},e),{guardsResult:c})))})}function ca(r,n,e,t){return N(r).pipe(F(s=>pa(s.component,s.route,e,n,t)),W(s=>s!==!0,!0))}function la(r,n,e,t){return N(n).pipe(fe(s=>An(ha(s.route.parent,t),ua(s.route,t),fa(r,s.path,e),da(r,s.route,e))),W(s=>s!==!0,!0))}function ua(r,n){return r!==null&&n&&n(new Zr(r)),p(!0)}function ha(r,n){return r!==null&&n&&n(new Kr(r)),p(!0)}function da(r,n,e){let t=n.routeConfig?n.routeConfig.canActivate:null;if(!t||t.length===0)return p(!0);let s=t.map(i=>ar(()=>{let o=pt(n)??e,c=Ue(i,o),a=ra(c)?c.canActivate(n,r):K(o,()=>c(n,r));return de(a).pipe(W())}));return p(s).pipe(Oe())}function fa(r,n,e){let t=n[n.length-1],i=n.slice(0,n.length-1).reverse().map(o=>Zo(o)).filter(o=>o!==null).map(o=>ar(()=>{let c=o.guards.map(a=>{let l=pt(o.node)??e,h=Ue(a,l),u=na(h)?h.canActivateChild(t,r):K(l,()=>h(t,r));return de(u).pipe(W())});return p(c).pipe(Oe())}));return p(i).pipe(Oe())}function pa(r,n,e,t,s){let i=n&&n.routeConfig?n.routeConfig.canDeactivate:null;if(!i||i.length===0)return p(!0);let o=i.map(c=>{let a=pt(n)??s,l=Ue(c,a),h=sa(l)?l.canDeactivate(r,n,e,t):K(a,()=>l(r,n,e,t));return de(h).pipe(W())});return p(o).pipe(Oe())}function ga(r,n,e,t){let s=n.canLoad;if(s===void 0||s.length===0)return p(!0);let i=s.map(o=>{let c=Ue(o,r),a=ta(c)?c.canLoad(n,e):K(r,()=>c(n,e));return de(a)});return p(i).pipe(Oe(),ii(t))}function ii(r){return Cn(x(n=>{if(typeof n!="boolean")throw Jt(r,n)}),C(n=>n===!0))}function ma(r,n,e,t){let s=n.canMatch;if(!s||s.length===0)return p(!0);let i=s.map(o=>{let c=Ue(o,r),a=ia(c)?c.canMatch(n,e):K(r,()=>c(n,e));return de(a)});return p(i).pipe(Oe(),ii(t))}var ht=class{constructor(n){this.segmentGroup=n||null}},dt=class extends Error{constructor(n){super(),this.urlTree=n}};function ke(r){return re(new ht(r))}function va(r){return re(new A(4e3,!1))}function ya(r){return re(ri(!1,B.GuardRejected))}var on=class{constructor(n,e){this.urlSerializer=n,this.urlTree=e}lineralizeSegments(n,e){let t=[],s=e.root;for(;;){if(t=t.concat(s.segments),s.numberOfChildren===0)return p(t);if(s.numberOfChildren>1||!s.children[S])return va(`${n.redirectTo}`);s=s.children[S]}}applyRedirectCommands(n,e,t,s,i){if(typeof e!="string"){let c=e,{queryParams:a,fragment:l,routeConfig:h,url:u,outlet:f,params:d,data:g,title:v}=s,b=K(i,()=>c({params:d,data:g,queryParams:a,fragment:l,routeConfig:h,url:u,outlet:f,title:v}));if(b instanceof se)throw new dt(b);e=b}let o=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),n,t);if(e[0]==="/")throw new dt(o);return o}applyRedirectCreateUrlTree(n,e,t,s){let i=this.createSegmentGroup(n,e.root,t,s);return new se(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(n,e){let t={};return Object.entries(n).forEach(([s,i])=>{if(typeof i=="string"&&i[0]===":"){let c=i.substring(1);t[s]=e[c]}else t[s]=i}),t}createSegmentGroup(n,e,t,s){let i=this.createSegments(n,e.segments,t,s),o={};return Object.entries(e.children).forEach(([c,a])=>{o[c]=this.createSegmentGroup(n,a,t,s)}),new I(i,o)}createSegments(n,e,t,s){return e.map(i=>i.path[0]===":"?this.findPosParam(n,i,s):this.findOrReturn(i,t))}findPosParam(n,e,t){let s=t[e.path.substring(1)];if(!s)throw new A(4001,!1);return s}findOrReturn(n,e){let t=0;for(let s of e){if(s.path===n.path)return e.splice(t),s;t++}return n}},an={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function wa(r,n,e,t,s){let i=oi(r,n,e);return i.matched?(t=zo(n,t),ma(t,n,e,s).pipe(C(o=>o===!0?i:m({},an)))):p(i)}function oi(r,n,e){if(n.path==="**")return ba(e);if(n.path==="")return n.pathMatch==="full"&&(r.hasChildren()||e.length>0)?m({},an):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let s=(n.matcher||go)(e,r,n);if(!s)return m({},an);let i={};Object.entries(s.posParams??{}).forEach(([c,a])=>{i[c]=a.path});let o=s.consumed.length>0?m(m({},i),s.consumed[s.consumed.length-1].parameters):i;return{matched:!0,consumedSegments:s.consumed,remainingSegments:e.slice(s.consumed.length),parameters:o,positionalParamSegments:s.posParams??{}}}function ba(r){return{matched:!0,parameters:r.length>0?Fs(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}function Us(r,n,e,t){return e.length>0&&Ra(r,e,t)?{segmentGroup:new I(n,Ta(t,new I(e,r.children))),slicedSegments:[]}:e.length===0&&Ca(r,e,t)?{segmentGroup:new I(r.segments,Sa(r,e,t,r.children)),slicedSegments:e}:{segmentGroup:new I(r.segments,r.children),slicedSegments:e}}function Sa(r,n,e,t){let s={};for(let i of e)if(Zt(r,n,i)&&!t[Q(i)]){let o=new I([],{});s[Q(i)]=o}return m(m({},t),s)}function Ta(r,n){let e={};e[S]=n;for(let t of r)if(t.path===""&&Q(t)!==S){let s=new I([],{});e[Q(t)]=s}return e}function Ra(r,n,e){return e.some(t=>Zt(r,n,t)&&Q(t)!==S)}function Ca(r,n,e){return e.some(t=>Zt(r,n,t))}function Zt(r,n,e){return(r.hasChildren()||n.length>0)&&e.pathMatch==="full"?!1:e.path===""}function Ia(r,n,e){return n.length===0&&!r.children[e]}var cn=class{};function ka(r,n,e,t,s,i,o="emptyOnly"){return new ln(r,n,e,t,s,o,i).recognize()}var Ea=31,ln=class{constructor(n,e,t,s,i,o,c){this.injector=n,this.configLoader=e,this.rootComponentType=t,this.config=s,this.urlTree=i,this.paramsInheritanceStrategy=o,this.urlSerializer=c,this.applyRedirects=new on(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(n){return new A(4002,`'${n.segmentGroup}'`)}recognize(){let n=Us(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(n).pipe(C(({children:e,rootSnapshot:t})=>{let s=new H(t,e),i=new Gt("",s),o=Oo(t,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,i.url=this.urlSerializer.serialize(o),{state:i,tree:o}}))}match(n){let e=new _e([],Object.freeze({}),Object.freeze(m({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),S,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,n,S,e).pipe(C(t=>({children:t,rootSnapshot:e})),q(t=>{if(t instanceof dt)return this.urlTree=t.urlTree,this.match(t.urlTree.root);throw t instanceof ht?this.noMatchError(t):t}))}processSegmentGroup(n,e,t,s,i){return t.segments.length===0&&t.hasChildren()?this.processChildren(n,e,t,i):this.processSegment(n,e,t,t.segments,s,!0,i).pipe(C(o=>o instanceof H?[o]:[]))}processChildren(n,e,t,s){let i=[];for(let o of Object.keys(t.children))o==="primary"?i.unshift(o):i.push(o);return N(i).pipe(fe(o=>{let c=t.children[o],a=Ho(e,o);return this.processSegmentGroup(n,a,c,o,s)}),On((o,c)=>(o.push(...c),o)),cr(null),Dn(),F(o=>{if(o===null)return ke(t);let c=ai(o);return Aa(c),p(c)}))}processSegment(n,e,t,s,i,o,c){return N(e).pipe(fe(a=>this.processSegmentAgainstRoute(a._injector??n,e,a,t,s,i,o,c).pipe(q(l=>{if(l instanceof ht)return p(null);throw l}))),W(a=>!!a),q(a=>{if(si(a))return Ia(t,s,i)?p(new cn):ke(t);throw a}))}processSegmentAgainstRoute(n,e,t,s,i,o,c,a){return Q(t)!==o&&(o===S||!Zt(s,i,t))?ke(s):t.redirectTo===void 0?this.matchSegmentAgainstRoute(n,s,t,i,o,a):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(n,s,e,t,i,o,a):ke(s)}expandSegmentAgainstRouteUsingRedirect(n,e,t,s,i,o,c){let{matched:a,parameters:l,consumedSegments:h,positionalParamSegments:u,remainingSegments:f}=oi(e,s,i);if(!a)return ke(e);typeof s.redirectTo=="string"&&s.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Ea&&(this.allowRedirects=!1));let d=new _e(i,l,Object.freeze(m({},this.urlTree.queryParams)),this.urlTree.fragment,Ns(s),Q(s),s.component??s._loadedComponent??null,s,Ls(s)),g=Wt(d,c,this.paramsInheritanceStrategy);d.params=Object.freeze(g.params),d.data=Object.freeze(g.data);let v=this.applyRedirects.applyRedirectCommands(h,s.redirectTo,u,d,n);return this.applyRedirects.lineralizeSegments(s,v).pipe(F(b=>this.processSegment(n,t,e,b.concat(f),o,!1,c)))}matchSegmentAgainstRoute(n,e,t,s,i,o){let c=wa(e,t,s,n,this.urlSerializer);return t.path==="**"&&(e.children={}),c.pipe($(a=>a.matched?(n=t._injector??n,this.getChildConfig(n,t,s).pipe($(({routes:l})=>{let h=t._loadedInjector??n,{parameters:u,consumedSegments:f,remainingSegments:d}=a,g=new _e(f,u,Object.freeze(m({},this.urlTree.queryParams)),this.urlTree.fragment,Ns(t),Q(t),t.component??t._loadedComponent??null,t,Ls(t)),v=Wt(g,o,this.paramsInheritanceStrategy);g.params=Object.freeze(v.params),g.data=Object.freeze(v.data);let{segmentGroup:b,slicedSegments:E}=Us(e,f,d,l);if(E.length===0&&b.hasChildren())return this.processChildren(h,l,b,g).pipe(C(k=>new H(g,k)));if(l.length===0&&E.length===0)return p(new H(g,[]));let T=Q(t)===i;return this.processSegment(h,l,b,E,T?S:i,!0,g).pipe(C(k=>new H(g,k instanceof H?[k]:[])))}))):ke(e)))}getChildConfig(n,e,t){return e.children?p({routes:e.children,injector:n}):e.loadChildren?e._loadedRoutes!==void 0?p({routes:e._loadedRoutes,injector:e._loadedInjector}):ga(n,e,t,this.urlSerializer).pipe(F(s=>s?this.configLoader.loadChildren(n,e).pipe(x(i=>{e._loadedRoutes=i.routes,e._loadedInjector=i.injector})):ya(e))):p({routes:[],injector:n})}};function Aa(r){r.sort((n,e)=>n.value.outlet===S?-1:e.value.outlet===S?1:n.value.outlet.localeCompare(e.value.outlet))}function _a(r){let n=r.value.routeConfig;return n&&n.path===""}function ai(r){let n=[],e=new Set;for(let t of r){if(!_a(t)){n.push(t);continue}let s=n.find(i=>t.value.routeConfig===i.value.routeConfig);s!==void 0?(s.children.push(...t.children),e.add(s)):n.push(t)}for(let t of e){let s=ai(t.children);n.push(new H(t.value,s))}return n.filter(t=>!e.has(t))}function Ns(r){return r.data||{}}function Ls(r){return r.resolve||{}}function Ma(r,n,e,t,s,i){return F(o=>ka(r,n,e,t,o.extractedUrl,s,i).pipe(C(({state:c,tree:a})=>U(m({},o),{targetSnapshot:c,urlAfterRedirects:a}))))}function xa(r,n){return F(e=>{let{targetSnapshot:t,guards:{canActivateChecks:s}}=e;if(!s.length)return p(e);let i=new Set(s.map(a=>a.route)),o=new Set;for(let a of i)if(!o.has(a))for(let l of ci(a))o.add(l);let c=0;return N(o).pipe(fe(a=>i.has(a)?Pa(a,t,r,n):(a.data=Wt(a,a.parent,r).resolve,p(void 0))),x(()=>c++),lr(1),F(a=>c===o.size?p(e):ae))})}function ci(r){let n=r.children.map(e=>ci(e)).flat();return[r,...n]}function Pa(r,n,e,t){let s=r.routeConfig,i=r._resolve;return s?.title!==void 0&&!ei(s)&&(i[ft]=s.title),Da(i,r,n,t).pipe(C(o=>(r._resolvedData=o,r.data=Wt(r,r.parent,e).resolve,null)))}function Da(r,n,e,t){let s=jr(r);if(s.length===0)return p({});let i={};return N(s).pipe(F(o=>Oa(r[o],n,e,t).pipe(W(),x(c=>{if(c instanceof ut)throw Jt(new nt,c);i[o]=c}))),lr(1),Pn(i),q(o=>si(o)?ae:re(o)))}function Oa(r,n,e,t){let s=pt(n)??t,i=Ue(r,s),o=i.resolve?i.resolve(n,e):K(s,()=>i(n,e));return de(o)}function Nr(r){return $(n=>{let e=r(n);return e?N(e).pipe(C(()=>n)):p(n)})}var li=(()=>{class r{buildTitle(e){let t,s=e.root;for(;s!==void 0;)t=this.getResolvedTitleForRoute(s)??t,s=s.children.find(i=>i.outlet===S);return t}getResolvedTitleForRoute(e){return e.data[ft]}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:()=>y(Ua),providedIn:"root"})}}return r})(),Ua=(()=>{class r extends li{constructor(e){super(),this.title=e}updateTitle(e){let t=this.buildTitle(e);t!==void 0&&this.title.setTitle(t)}static{this.\u0275fac=function(t){return new(t||r)(w(Ms))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),pn=new _("",{providedIn:"root",factory:()=>({})}),Na=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=jn({type:r,selectors:[["ng-component"]],standalone:!0,features:[ns],decls:1,vars:0,template:function(t,s){t&1&&rs(0,"router-outlet")},dependencies:[Vo],encapsulation:2})}}return r})();function gn(r){let n=r.children&&r.children.map(gn),e=n?U(m({},r),{children:n}):m({},r);return!e.component&&!e.loadComponent&&(n||e.loadChildren)&&e.outlet&&e.outlet!==S&&(e.component=Na),e}var mn=new _(""),La=(()=>{class r{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=y(gr)}loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return p(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let t=de(e.loadComponent()).pipe(C(ui),x(i=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=i}),Te(()=>{this.componentLoaders.delete(e)})),s=new or(t,()=>new X).pipe(ir());return this.componentLoaders.set(e,s),s}loadChildren(e,t){if(this.childrenLoaders.get(t))return this.childrenLoaders.get(t);if(t._loadedRoutes)return p({routes:t._loadedRoutes,injector:t._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(t);let i=ja(t,this.compiler,e,this.onLoadEndListener).pipe(Te(()=>{this.childrenLoaders.delete(t)})),o=new or(i,()=>new X).pipe(ir());return this.childrenLoaders.set(t,o),o}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function ja(r,n,e,t){return de(r.loadChildren()).pipe(C(ui),F(s=>s instanceof es||Array.isArray(s)?p(s):N(n.compileModuleAsync(s))),C(s=>{t&&t(r);let i,o,c=!1;return Array.isArray(s)?(o=s,c=!0):(i=s.create(e).injector,o=i.get(mn,[],{optional:!0,self:!0}).flat()),{routes:o.map(gn),injector:i}}))}function Fa(r){return r&&typeof r=="object"&&"default"in r}function ui(r){return Fa(r)?r.default:r}var vn=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:()=>y($a),providedIn:"root"})}}return r})(),$a=(()=>{class r{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),za=new _("");var Ha=new _(""),Ba=(()=>{class r{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new X,this.transitionAbortSubject=new X,this.configLoader=y(La),this.environmentInjector=y(Re),this.urlSerializer=y(hn),this.rootContexts=y(Qt),this.location=y(kt),this.inputBindingEnabled=y(fn,{optional:!0})!==null,this.titleStrategy=y(li),this.options=y(pn,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=y(vn),this.createViewTransition=y(za,{optional:!0}),this.navigationErrorHandler=y(Ha,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>p(void 0),this.rootComponentType=null;let e=s=>this.events.next(new Gr(s)),t=s=>this.events.next(new Jr(s));this.configLoader.onLoadEndListener=t,this.configLoader.onLoadStartListener=e}complete(){this.transitions?.complete()}handleNavigationRequest(e){let t=++this.navigationId;this.transitions?.next(U(m(m({},this.transitions.value),e),{id:t}))}setupNavigations(e,t,s){return this.transitions=new V({id:0,currentUrlTree:t,currentRawUrl:t,extractedUrl:this.urlHandlingStrategy.extract(t),urlAfterRedirects:this.urlHandlingStrategy.extract(t),rawUrl:t,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:tt,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(P(i=>i.id!==0),C(i=>U(m({},i),{extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),$(i=>{let o=!1,c=!1;return p(i).pipe($(a=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",B.SupersededByNewNavigation),ae;this.currentTransition=i,this.currentNavigation={id:a.id,initialUrl:a.rawUrl,extractedUrl:a.extractedUrl,targetBrowserUrl:typeof a.extras.browserUrl=="string"?this.urlSerializer.parse(a.extras.browserUrl):a.extras.browserUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?U(m({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let l=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=a.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!l&&h!=="reload"){let u="";return this.events.next(new be(a.id,this.urlSerializer.serialize(a.rawUrl),u,Hr.IgnoredSameUrlNavigation)),a.resolve(!1),ae}if(this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return p(a).pipe($(u=>{let f=this.transitions?.getValue();return this.events.next(new ot(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),f!==this.transitions?.getValue()?ae:Promise.resolve(u)}),Ma(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),x(u=>{i.targetSnapshot=u.targetSnapshot,i.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation=U(m({},this.currentNavigation),{finalUrl:u.urlAfterRedirects});let f=new Bt(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(a.currentRawUrl)){let{id:u,extractedUrl:f,source:d,restoredState:g,extras:v}=a,b=new ot(u,this.urlSerializer.serialize(f),d,g);this.events.next(b);let E=Xs(this.rootComponentType).snapshot;return this.currentTransition=i=U(m({},a),{targetSnapshot:E,urlAfterRedirects:f,extras:U(m({},v),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,p(i)}else{let u="";return this.events.next(new be(a.id,this.urlSerializer.serialize(a.extractedUrl),u,Hr.IgnoredByUrlHandlingStrategy)),a.resolve(!1),ae}}),x(a=>{let l=new Br(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(l)}),C(a=>(this.currentTransition=i=U(m({},a),{guards:Qo(a.targetSnapshot,a.currentSnapshot,this.rootContexts)}),i)),aa(this.environmentInjector,a=>this.events.next(a)),x(a=>{if(i.guardsResult=a.guardsResult,a.guardsResult&&typeof a.guardsResult!="boolean")throw Jt(this.urlSerializer,a.guardsResult);let l=new Vr(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.events.next(l)}),P(a=>a.guardsResult?!0:(this.cancelNavigationTransition(a,"",B.GuardRejected),!1)),Nr(a=>{if(a.guards.canActivateChecks.length)return p(a).pipe(x(l=>{let h=new qr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),$(l=>{let h=!1;return p(l).pipe(xa(this.paramsInheritanceStrategy,this.environmentInjector),x({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(l,"",B.NoDataFromResolver)}}))}),x(l=>{let h=new Wr(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}))}),Nr(a=>{let l=h=>{let u=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(h.routeConfig).pipe(x(f=>{h.component=f}),C(()=>{})));for(let f of h.children)u.push(...l(f));return u};return Le(l(a.targetSnapshot.root)).pipe(cr(null),ce(1))}),Nr(()=>this.afterPreactivation()),$(()=>{let{currentSnapshot:a,targetSnapshot:l}=i,h=this.createViewTransition?.(this.environmentInjector,a.root,l.root);return h?N(h).pipe(C(()=>i)):p(i)}),C(a=>{let l=qo(e.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return this.currentTransition=i=U(m({},a),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,i}),x(()=>{this.events.next(new ct)}),Ko(this.rootContexts,e.routeReuseStrategy,a=>this.events.next(a),this.inputBindingEnabled),ce(1),x({next:a=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new we(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects))),this.titleStrategy?.updateTitle(a.targetRouterState.snapshot),a.resolve(!0)},complete:()=>{o=!0}}),Nn(this.transitionAbortSubject.pipe(x(a=>{throw a}))),Te(()=>{!o&&!c&&this.cancelNavigationTransition(i,"",B.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation=null,this.currentTransition=null)}),q(a=>{if(c=!0,ni(a))this.events.next(new ne(i.id,this.urlSerializer.serialize(i.extractedUrl),a.message,a.cancellationCode)),Jo(a)?this.events.next(new Pe(a.url,a.navigationBehaviorOptions)):i.resolve(!1);else{let l=new at(i.id,this.urlSerializer.serialize(i.extractedUrl),a,i.targetSnapshot??void 0);try{let h=K(this.environmentInjector,()=>this.navigationErrorHandler?.(l));if(h instanceof ut){let{message:u,cancellationCode:f}=Jt(this.urlSerializer,h);this.events.next(new ne(i.id,this.urlSerializer.serialize(i.extractedUrl),u,f)),this.events.next(new Pe(h.redirectTo,h.navigationBehaviorOptions))}else{this.events.next(l);let u=e.errorHandler(a);i.resolve(!!u)}}catch(h){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(h)}}return ae}))}))}cancelNavigationTransition(e,t,s){let i=new ne(e.id,this.urlSerializer.serialize(e.extractedUrl),t,s);this.events.next(i),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),t=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==t?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Va(r){return r!==tt}var qa=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:()=>y(Wa),providedIn:"root"})}}return r})(),un=class{shouldDetach(n){return!1}store(n,e){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,e){return n.routeConfig===e.routeConfig}},Wa=(()=>{class r extends un{static{this.\u0275fac=(()=>{let e;return function(s){return(e||(e=ze(r)))(s||r)}})()}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),hi=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:()=>y(Ga),providedIn:"root"})}}return r})(),Ga=(()=>{class r extends hi{constructor(){super(...arguments),this.location=y(kt),this.urlSerializer=y(hn),this.options=y(pn,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=y(vn),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new se,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Xs(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(t=>{t.type==="popstate"&&e(t.url,t.state)})}handleRouterEvent(e,t){if(e instanceof ot)this.stateMemento=this.createStateMemento();else if(e instanceof be)this.rawUrlTree=t.initialUrl;else if(e instanceof Bt){if(this.urlUpdateStrategy==="eager"&&!t.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(t.finalUrl,t.initialUrl);this.setBrowserUrl(t.targetBrowserUrl??s,t)}}else e instanceof ct?(this.currentUrlTree=t.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(t.finalUrl,t.initialUrl),this.routerState=t.targetRouterState,this.urlUpdateStrategy==="deferred"&&!t.extras.skipLocationChange&&this.setBrowserUrl(t.targetBrowserUrl??this.rawUrlTree,t)):e instanceof ne&&(e.code===B.GuardRejected||e.code===B.NoDataFromResolver)?this.restoreHistory(t):e instanceof at?this.restoreHistory(t,!0):e instanceof we&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,t){let s=e instanceof se?this.urlSerializer.serialize(e):e;if(this.location.isCurrentPathEqualTo(s)||t.extras.replaceUrl){let i=this.browserPageId,o=m(m({},t.extras.state),this.generateNgRouterState(t.id,i));this.location.replaceState(s,"",o)}else{let i=m(m({},t.extras.state),this.generateNgRouterState(t.id,this.browserPageId+1));this.location.go(s,"",i)}}restoreHistory(e,t=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,i=this.currentPageId-s;i!==0?this.location.historyGo(i):this.currentUrlTree===e.finalUrl&&i===0&&(this.resetState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(t&&this.resetState(e),this.resetUrlToCurrentUrlTree())}resetState(e){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,t){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:t}:{navigationId:e}}static{this.\u0275fac=(()=>{let e;return function(s){return(e||(e=ze(r)))(s||r)}})()}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})(),Ye=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(Ye||{});function Ja(r,n){r.events.pipe(P(e=>e instanceof we||e instanceof ne||e instanceof at||e instanceof be),C(e=>e instanceof we||e instanceof be?Ye.COMPLETE:(e instanceof ne?e.code===B.Redirect||e.code===B.SupersededByNewNavigation:!1)?Ye.REDIRECTING:Ye.FAILED),P(e=>e!==Ye.REDIRECTING),ce(1)).subscribe(()=>{n()})}function Ka(r){throw r}var Qa={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Za={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},di=(()=>{class r{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=y(St),this.stateManager=y(hi),this.options=y(pn,{optional:!0})||{},this.pendingTasks=y(wt),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=y(Ba),this.urlSerializer=y(hn),this.location=y(kt),this.urlHandlingStrategy=y(vn),this._events=new X,this.errorHandler=this.options.errorHandler||Ka,this.navigated=!1,this.routeReuseStrategy=y(qa),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=y(mn,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!y(fn,{optional:!0}),this.eventsSubscription=new Rn,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(t=>{try{let s=this.navigationTransitions.currentTransition,i=this.navigationTransitions.currentNavigation;if(s!==null&&i!==null){if(this.stateManager.handleRouterEvent(t,i),t instanceof ne&&t.code!==B.Redirect&&t.code!==B.SupersededByNewNavigation)this.navigated=!0;else if(t instanceof we)this.navigated=!0;else if(t instanceof Pe){let o=t.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(t.url,s.currentRawUrl),a=m({browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||this.urlUpdateStrategy==="eager"||Va(s.source)},o);this.scheduleNavigation(c,tt,null,a,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}Ya(t)&&this._events.next(t)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),tt,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,t)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(e,"popstate",t)},0)})}navigateToSyncWithBrowser(e,t,s){let i={replaceUrl:!0},o=s?.navigationId?s:null;if(s){let a=m({},s);delete a.navigationId,delete a.\u0275routerPageId,Object.keys(a).length!==0&&(i.state=a)}let c=this.parseUrl(e);this.scheduleNavigation(c,t,o,i)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(gn),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,t={}){let{relativeTo:s,queryParams:i,fragment:o,queryParamsHandling:c,preserveFragment:a}=t,l=a?this.currentUrlTree.fragment:o,h=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":h=m(m({},this.currentUrlTree.queryParams),i);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=i||null}h!==null&&(h=this.removeEmptyProps(h));let u;try{let f=s?s.snapshot:this.routerState.snapshot.root;u=Js(f)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),u=this.currentUrlTree.root}return Ks(u,e,h,l??null)}navigateByUrl(e,t={skipLocationChange:!1}){let s=st(e)?e:this.parseUrl(e),i=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(i,tt,null,t)}navigate(e,t={skipLocationChange:!1}){return Xa(e),this.navigateByUrl(this.createUrlTree(e,t),t)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,t){let s;if(t===!0?s=m({},Qa):t===!1?s=m({},Za):s=t,st(e))return xs(this.currentUrlTree,e,s);let i=this.parseUrl(e);return xs(this.currentUrlTree,i,s)}removeEmptyProps(e){return Object.entries(e).reduce((t,[s,i])=>(i!=null&&(t[s]=i),t),{})}scheduleNavigation(e,t,s,i,o){if(this.disposed)return Promise.resolve(!1);let c,a,l;o?(c=o.resolve,a=o.reject,l=o.promise):l=new Promise((u,f)=>{c=u,a=f});let h=this.pendingTasks.add();return Ja(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:t,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:i,resolve:c,reject:a,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(u=>Promise.reject(u))}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Xa(r){for(let n=0;n<r.length;n++)if(r[n]==null)throw new A(4008,!1)}function Ya(r){return!(r instanceof ct)&&!(r instanceof Pe)}var ec=new _("");function Ll(r,...n){return pe([{provide:mn,multi:!0,useValue:r},[],{provide:De,useFactory:tc,deps:[di]},{provide:pr,multi:!0,useFactory:rc},n.map(e=>e.\u0275providers)])}function tc(r){return r.routerState.root}function rc(){let r=y(Hn);return n=>{let e=r.get(Ct);if(n!==e.components[0])return;let t=r.get(di),s=r.get(nc);r.get(sc)===1&&t.initialNavigation(),r.get(ic,null,ur.Optional)?.setUpPreloading(),r.get(ec,null,ur.Optional)?.init(),t.resetRootComponentType(e.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}var nc=new _("",{factory:()=>new X}),sc=new _("",{providedIn:"root",factory:()=>1});var ic=new _("");var wn=class{validateSignature(n){return Promise.resolve(null)}validateAtHash(n){return Promise.resolve(!0)}},Xt=class{};var mt=class{},oc=(()=>{class r extends mt{now(){return Date.now()}new(){return new Date}static{this.\u0275fac=(()=>{let e;return function(s){return(e||(e=ze(r)))(s||r)}})()}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})();var Yt=class{},er=class{},ac=(()=>{class r{constructor(){this.data=new Map}getItem(e){return this.data.get(e)}removeItem(e){this.data.delete(e)}setItem(e,t){this.data.set(e,t)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})();var vt=class{constructor(n){this.type=n}},j=class extends vt{constructor(n,e=null){super(n),this.info=e}},Z=class extends vt{constructor(n,e=null){super(n),this.info=e}},M=class extends vt{constructor(n,e,t=null){super(n),this.reason=e,this.params=t}};function fi(r){let n=r.replace(/-/g,"+").replace(/_/g,"/");return decodeURIComponent(atob(n).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function pi(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var Ne=class{constructor(n){this.clientId="",this.redirectUri="",this.postLogoutRedirectUri="",this.redirectUriAsPostLogoutRedirectUriFallback=!0,this.loginUrl="",this.scope="openid profile",this.resource="",this.rngUrl="",this.oidc=!0,this.requestAccessToken=!0,this.options=null,this.issuer="",this.logoutUrl="",this.clearHashAfterLogin=!0,this.tokenEndpoint=null,this.revocationEndpoint=null,this.customTokenParameters=[],this.userinfoEndpoint=null,this.responseType="",this.showDebugInformation=!1,this.silentRefreshRedirectUri="",this.silentRefreshMessagePrefix="",this.silentRefreshShowIFrame=!1,this.siletRefreshTimeout=1e3*20,this.silentRefreshTimeout=1e3*20,this.dummyClientSecret="",this.requireHttps="remoteOnly",this.strictDiscoveryDocumentValidation=!0,this.jwks=null,this.customQueryParams=null,this.silentRefreshIFrameName="angular-oauth-oidc-silent-refresh-iframe",this.timeoutFactor=.75,this.sessionChecksEnabled=!1,this.sessionCheckIntervall=3*1e3,this.sessionCheckIFrameUrl=null,this.sessionCheckIFrameName="angular-oauth-oidc-check-session-iframe",this.disableAtHashCheck=!1,this.skipSubjectCheck=!1,this.useIdTokenHintForSilentRefresh=!1,this.skipIssuerCheck=!1,this.nonceStateSeparator=";",this.useHttpBasicAuth=!1,this.decreaseExpirationBySec=0,this.waitForTokenInMsec=0,this.disablePKCE=!1,this.preserveRequestedRoute=!1,this.disableIdTokenTimer=!1,this.checkOrigin=!1,this.openUri=e=>{location.href=e},n&&Object.assign(this,n)}},Se=class{encodeKey(n){return encodeURIComponent(n)}encodeValue(n){return encodeURIComponent(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}},tr=class{};var gi=(()=>{class r{getHashFragmentParams(e){let t=e||window.location.hash;if(t=decodeURIComponent(t),t.indexOf("#")!==0)return{};let s=t.indexOf("?");return s>-1?t=t.substr(s+1):t=t.substr(1),this.parseQueryString(t)}parseQueryString(e){let t={},s,i,o,c,a,l;if(e===null)return t;let h=e.split("&");for(let u=0;u<h.length;u++)s=h[u],i=s.indexOf("="),i===-1?(o=s,c=null):(o=s.substr(0,i),c=s.substr(i+1)),a=decodeURIComponent(o),l=decodeURIComponent(c),a.substr(0,1)==="/"&&(a=a.substr(1)),t[a]=l;return t}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),mi=32,cc=64,lc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function yn(r,n,e,t,s){let i,o,c,a,l,h,u,f,d,g,v,b,E;for(;s>=64;){for(i=n[0],o=n[1],c=n[2],a=n[3],l=n[4],h=n[5],u=n[6],f=n[7],g=0;g<16;g++)v=t+g*4,r[g]=(e[v]&255)<<24|(e[v+1]&255)<<16|(e[v+2]&255)<<8|e[v+3]&255;for(g=16;g<64;g++)d=r[g-2],b=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,d=r[g-15],E=(d>>>7|d<<25)^(d>>>18|d<<14)^d>>>3,r[g]=(b+r[g-7]|0)+(E+r[g-16]|0);for(g=0;g<64;g++)b=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&h^~l&u)|0)+(f+(lc[g]+r[g]|0)|0)|0,E=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&o^i&c^o&c)|0,f=u,u=h,h=l,l=a+b|0,a=c,c=o,o=i,i=b+E|0;n[0]+=i,n[1]+=o,n[2]+=c,n[3]+=a,n[4]+=l,n[5]+=h,n[6]+=u,n[7]+=f,t+=64,s-=64}return t}var bn=class{constructor(){this.digestLength=mi,this.blockSize=cc,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}reset(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this}clean(){for(let n=0;n<this.buffer.length;n++)this.buffer[n]=0;for(let n=0;n<this.temp.length;n++)this.temp[n]=0;this.reset()}update(n,e=n.length){if(this.finished)throw new Error("SHA256: can't update because hash was finished.");let t=0;if(this.bytesHashed+=e,this.bufferLength>0){for(;this.bufferLength<64&&e>0;)this.buffer[this.bufferLength++]=n[t++],e--;this.bufferLength===64&&(yn(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(e>=64&&(t=yn(this.temp,this.state,n,t,e),e%=64);e>0;)this.buffer[this.bufferLength++]=n[t++],e--;return this}finish(n){if(!this.finished){let e=this.bytesHashed,t=this.bufferLength,s=e/536870912|0,i=e<<3,o=e%64<56?64:128;this.buffer[t]=128;for(let c=t+1;c<o-8;c++)this.buffer[c]=0;this.buffer[o-8]=s>>>24&255,this.buffer[o-7]=s>>>16&255,this.buffer[o-6]=s>>>8&255,this.buffer[o-5]=s>>>0&255,this.buffer[o-4]=i>>>24&255,this.buffer[o-3]=i>>>16&255,this.buffer[o-2]=i>>>8&255,this.buffer[o-1]=i>>>0&255,yn(this.temp,this.state,this.buffer,0,o),this.finished=!0}for(let e=0;e<8;e++)n[e*4+0]=this.state[e]>>>24&255,n[e*4+1]=this.state[e]>>>16&255,n[e*4+2]=this.state[e]>>>8&255,n[e*4+3]=this.state[e]>>>0&255;return this}digest(){let n=new Uint8Array(this.digestLength);return this.finish(n),n}_saveState(n){for(let e=0;e<this.state.length;e++)n[e]=this.state[e]}_restoreState(n,e){for(let t=0;t<this.state.length;t++)this.state[t]=n[t];this.bytesHashed=e,this.finished=!1,this.bufferLength=0}};function uc(r){let n=new bn().update(r),e=n.digest();return n.clean(),e}var Kl=new Uint8Array(mi);var rr=class{};function hc(r){if(typeof r!="string")throw new TypeError("expected string");let n=r,e=new Uint8Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}function dc(r){let n=[];for(let e=0;e<r.length;e++)n.push(String.fromCharCode(r[e]));return n.join("")}var fc=(()=>{class r{calcHash(e,t){return te(this,null,function*(){return dc(uc(hc(e)))})}toHashString2(e){let t="";for(let s of e)t+=String.fromCharCode(s);return t}toHashString(e){let t=new Uint8Array(e),s="";for(let i of t)s+=String.fromCharCode(i);return s}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),vi=(()=>{class r extends Ne{constructor(e,t,s,i,o,c,a,l,h,u){super(),this.ngZone=e,this.http=t,this.config=o,this.urlHelper=c,this.logger=a,this.crypto=l,this.dateTimeService=u,this.discoveryDocumentLoaded=!1,this.state="",this.eventsSubject=new X,this.discoveryDocumentLoadedSubject=new X,this.grantTypesSupported=[],this.inImplicitFlow=!1,this.saveNoncesInLocalStorage=!1,this.debug("angular-oauth2-oidc v10"),this.document=h,o||(o={}),this.discoveryDocumentLoaded$=this.discoveryDocumentLoadedSubject.asObservable(),this.events=this.eventsSubject.asObservable(),i&&(this.tokenValidationHandler=i),o&&this.configure(o);try{s?this.setStorage(s):typeof sessionStorage<"u"&&this.setStorage(sessionStorage)}catch(f){console.error("No OAuthStorage provided and cannot access default (sessionStorage).Consider providing a custom OAuthStorage implementation in your module.",f)}if(this.checkLocalStorageAccessable()){let f=window?.navigator?.userAgent;(f?.includes("MSIE ")||f?.includes("Trident"))&&(this.saveNoncesInLocalStorage=!0)}this.setupRefreshTimer()}checkLocalStorageAccessable(){if(typeof window>"u")return!1;let e="test";try{return typeof window.localStorage>"u"?!1:(localStorage.setItem(e,e),localStorage.removeItem(e),!0)}catch{return!1}}configure(e){Object.assign(this,new Ne,e),this.config=Object.assign({},new Ne,e),this.sessionChecksEnabled&&this.setupSessionCheck(),this.configChanged()}configChanged(){this.setupRefreshTimer()}restartSessionChecksIfStillLoggedIn(){this.hasValidIdToken()&&this.initSessionCheck()}restartRefreshTimerIfStillLoggedIn(){this.setupExpirationTimers()}setupSessionCheck(){this.events.pipe(P(e=>e.type==="token_received")).subscribe(()=>{this.initSessionCheck()})}setupAutomaticSilentRefresh(e={},t,s=!0){let i=!0;this.clearAutomaticRefreshTimer(),this.automaticRefreshSubscription=this.events.pipe(x(o=>{o.type==="token_received"?i=!0:o.type==="logout"&&(i=!1)}),P(o=>o.type==="token_expires"&&(t==null||t==="any"||o.info===t)),xn(1e3)).subscribe(()=>{i&&this.refreshInternal(e,s).catch(()=>{this.debug("Automatic silent refresh did not work")})}),this.restartRefreshTimerIfStillLoggedIn()}refreshInternal(e,t){return!this.useSilentRefresh&&this.responseType==="code"?this.refreshToken():this.silentRefresh(e,t)}loadDiscoveryDocumentAndTryLogin(e=null){return this.loadDiscoveryDocument().then(()=>this.tryLogin(e))}loadDiscoveryDocumentAndLogin(e=null){return e=e||{},this.loadDiscoveryDocumentAndTryLogin(e).then(()=>{if(!this.hasValidIdToken()||!this.hasValidAccessToken()){let t=typeof e.state=="string"?e.state:"";return this.initLoginFlow(t),!1}else return!0})}debug(...e){this.showDebugInformation&&this.logger.debug(...e)}validateUrlFromDiscoveryDocument(e){let t=[],s=this.validateUrlForHttps(e),i=this.validateUrlAgainstIssuer(e);return s||t.push("https for all urls required. Also for urls received by discovery."),i||t.push("Every url in discovery document has to start with the issuer url.Also see property strictDiscoveryDocumentValidation."),t}validateUrlForHttps(e){if(!e)return!0;let t=e.toLowerCase();return this.requireHttps===!1||(t.match(/^http:\/\/localhost($|[:/])/)||t.match(/^http:\/\/localhost($|[:/])/))&&this.requireHttps==="remoteOnly"?!0:t.startsWith("https://")}assertUrlNotNullAndCorrectProtocol(e,t){if(!e)throw new Error(`'${t}' should not be null`);if(!this.validateUrlForHttps(e))throw new Error(`'${t}' must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).`)}validateUrlAgainstIssuer(e){return!this.strictDiscoveryDocumentValidation||!e?!0:e.toLowerCase().startsWith(this.issuer.toLowerCase())}setupRefreshTimer(){if(typeof window>"u"){this.debug("timer not supported on this plattform");return}(this.hasValidIdToken()||this.hasValidAccessToken())&&(this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()),this.tokenReceivedSubscription&&this.tokenReceivedSubscription.unsubscribe(),this.tokenReceivedSubscription=this.events.pipe(P(e=>e.type==="token_received")).subscribe(()=>{this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()})}setupExpirationTimers(){this.hasValidAccessToken()&&this.setupAccessTokenTimer(),!this.disableIdTokenTimer&&this.hasValidIdToken()&&this.setupIdTokenTimer()}setupAccessTokenTimer(){let e=this.getAccessTokenExpiration(),t=this.getAccessTokenStoredAt(),s=this.calcTimeout(t,e);this.ngZone.runOutsideAngular(()=>{this.accessTokenTimeoutSubscription=p(new Z("token_expires","access_token")).pipe(yt(s)).subscribe(i=>{this.ngZone.run(()=>{this.eventsSubject.next(i)})})})}setupIdTokenTimer(){let e=this.getIdTokenExpiration(),t=this.getIdTokenStoredAt(),s=this.calcTimeout(t,e);this.ngZone.runOutsideAngular(()=>{this.idTokenTimeoutSubscription=p(new Z("token_expires","id_token")).pipe(yt(s)).subscribe(i=>{this.ngZone.run(()=>{this.eventsSubject.next(i)})})})}stopAutomaticRefresh(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.clearAutomaticRefreshTimer()}clearAccessTokenTimer(){this.accessTokenTimeoutSubscription&&this.accessTokenTimeoutSubscription.unsubscribe()}clearIdTokenTimer(){this.idTokenTimeoutSubscription&&this.idTokenTimeoutSubscription.unsubscribe()}clearAutomaticRefreshTimer(){this.automaticRefreshSubscription&&this.automaticRefreshSubscription.unsubscribe()}calcTimeout(e,t){let s=this.dateTimeService.now(),i=(t-e)*this.timeoutFactor-(s-e),o=Math.max(0,i),c=2147483647;return o>c?c:o}setStorage(e){this._storage=e,this.configChanged()}loadDiscoveryDocument(e=null){return new Promise((t,s)=>{if(e||(e=this.issuer||"",e.endsWith("/")||(e+="/"),e+=".well-known/openid-configuration"),!this.validateUrlForHttps(e)){s("issuer  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");return}this.http.get(e).subscribe(i=>{if(!this.validateDiscoveryDocument(i)){this.eventsSubject.next(new M("discovery_document_validation_error",null)),s("discovery_document_validation_error");return}this.loginUrl=i.authorization_endpoint,this.logoutUrl=i.end_session_endpoint||this.logoutUrl,this.grantTypesSupported=i.grant_types_supported,this.issuer=i.issuer,this.tokenEndpoint=i.token_endpoint,this.userinfoEndpoint=i.userinfo_endpoint||this.userinfoEndpoint,this.jwksUri=i.jwks_uri,this.sessionCheckIFrameUrl=i.check_session_iframe||this.sessionCheckIFrameUrl,this.discoveryDocumentLoaded=!0,this.discoveryDocumentLoadedSubject.next(i),this.revocationEndpoint=i.revocation_endpoint||this.revocationEndpoint,this.sessionChecksEnabled&&this.restartSessionChecksIfStillLoggedIn(),this.loadJwks().then(o=>{let c={discoveryDocument:i,jwks:o},a=new j("discovery_document_loaded",c);this.eventsSubject.next(a),t(a)}).catch(o=>{this.eventsSubject.next(new M("discovery_document_load_error",o)),s(o)})},i=>{this.logger.error("error loading discovery document",i),this.eventsSubject.next(new M("discovery_document_load_error",i)),s(i)})})}loadJwks(){return new Promise((e,t)=>{this.jwksUri?this.http.get(this.jwksUri).subscribe(s=>{this.jwks=s,e(s)},s=>{this.logger.error("error loading jwks",s),this.eventsSubject.next(new M("jwks_load_error",s)),t(s)}):e(null)})}validateDiscoveryDocument(e){let t;return!this.skipIssuerCheck&&e.issuer!==this.issuer?(this.logger.error("invalid issuer in discovery document","expected: "+this.issuer,"current: "+e.issuer),!1):(t=this.validateUrlFromDiscoveryDocument(e.authorization_endpoint),t.length>0?(this.logger.error("error validating authorization_endpoint in discovery document",t),!1):(t=this.validateUrlFromDiscoveryDocument(e.end_session_endpoint),t.length>0?(this.logger.error("error validating end_session_endpoint in discovery document",t),!1):(t=this.validateUrlFromDiscoveryDocument(e.token_endpoint),t.length>0&&this.logger.error("error validating token_endpoint in discovery document",t),t=this.validateUrlFromDiscoveryDocument(e.revocation_endpoint),t.length>0&&this.logger.error("error validating revocation_endpoint in discovery document",t),t=this.validateUrlFromDiscoveryDocument(e.userinfo_endpoint),t.length>0?(this.logger.error("error validating userinfo_endpoint in discovery document",t),!1):(t=this.validateUrlFromDiscoveryDocument(e.jwks_uri),t.length>0?(this.logger.error("error validating jwks_uri in discovery document",t),!1):(this.sessionChecksEnabled&&!e.check_session_iframe&&this.logger.warn("sessionChecksEnabled is activated but discovery document does not contain a check_session_iframe field"),!0)))))}fetchTokenUsingPasswordFlowAndLoadUserProfile(e,t,s=new D){return this.fetchTokenUsingPasswordFlow(e,t,s).then(()=>this.loadUserProfile())}loadUserProfile(){if(!this.hasValidAccessToken())throw new Error("Can not load User Profile without access_token");if(!this.validateUrlForHttps(this.userinfoEndpoint))throw new Error("userinfoEndpoint must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");return new Promise((e,t)=>{let s=new D().set("Authorization","Bearer "+this.getAccessToken());this.http.get(this.userinfoEndpoint,{headers:s,observe:"response",responseType:"text"}).subscribe(i=>{if(this.debug("userinfo received",JSON.stringify(i)),i.headers.get("content-type").startsWith("application/json")){let o=JSON.parse(i.body),c=this.getIdentityClaims()||{};if(!this.skipSubjectCheck&&this.oidc&&(!c.sub||o.sub!==c.sub)){t(`if property oidc is true, the received user-id (sub) has to be the user-id of the user that has logged in with oidc.
if you are not using oidc but just oauth2 password flow set oidc to false`);return}o=Object.assign({},c,o),this._storage.setItem("id_token_claims_obj",JSON.stringify(o)),this.eventsSubject.next(new j("user_profile_loaded")),e({info:o})}else this.debug("userinfo is not JSON, treating it as JWE/JWS"),this.eventsSubject.next(new j("user_profile_loaded")),e(JSON.parse(i.body))},i=>{this.logger.error("error loading user info",i),this.eventsSubject.next(new M("user_profile_load_error",i)),t(i)})})}fetchTokenUsingPasswordFlow(e,t,s=new D){let i={username:e,password:t};return this.fetchTokenUsingGrant("password",i,s)}fetchTokenUsingGrant(e,t,s=new D){this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let i=new z({encoder:new Se}).set("grant_type",e).set("scope",this.scope);if(this.useHttpBasicAuth){let o=btoa(`${this.clientId}:${this.dummyClientSecret}`);s=s.set("Authorization","Basic "+o)}if(this.useHttpBasicAuth||(i=i.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(i=i.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(let o of Object.getOwnPropertyNames(this.customQueryParams))i=i.set(o,this.customQueryParams[o]);for(let o of Object.keys(t))i=i.set(o,t[o]);return s=s.set("Content-Type","application/x-www-form-urlencoded"),new Promise((o,c)=>{this.http.post(this.tokenEndpoint,i,{headers:s}).subscribe(a=>{this.debug("tokenResponse",a),this.storeAccessTokenResponse(a.access_token,a.refresh_token,a.expires_in||this.fallbackAccessTokenExpirationTimeInSec,a.scope,this.extractRecognizedCustomParameters(a)),this.oidc&&a.id_token&&this.processIdToken(a.id_token,a.access_token).then(l=>{this.storeIdToken(l),o(a)}),this.eventsSubject.next(new j("token_received")),o(a)},a=>{this.logger.error("Error performing ${grantType} flow",a),this.eventsSubject.next(new M("token_error",a)),c(a)})})}refreshToken(){return this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint"),new Promise((e,t)=>{let s=new z({encoder:new Se}).set("grant_type","refresh_token").set("scope",this.scope).set("refresh_token",this._storage.getItem("refresh_token")),i=new D().set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){let o=btoa(`${this.clientId}:${this.dummyClientSecret}`);i=i.set("Authorization","Basic "+o)}if(this.useHttpBasicAuth||(s=s.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(s=s.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(let o of Object.getOwnPropertyNames(this.customQueryParams))s=s.set(o,this.customQueryParams[o]);this.http.post(this.tokenEndpoint,s,{headers:i}).pipe($(o=>this.oidc&&o.id_token?N(this.processIdToken(o.id_token,o.access_token,!0)).pipe(x(c=>this.storeIdToken(c)),C(()=>o)):p(o))).subscribe(o=>{this.debug("refresh tokenResponse",o),this.storeAccessTokenResponse(o.access_token,o.refresh_token,o.expires_in||this.fallbackAccessTokenExpirationTimeInSec,o.scope,this.extractRecognizedCustomParameters(o)),this.eventsSubject.next(new j("token_received")),this.eventsSubject.next(new j("token_refreshed")),e(o)},o=>{this.logger.error("Error refreshing token",o),this.eventsSubject.next(new M("token_refresh_error",o)),t(o)})})}removeSilentRefreshEventListener(){this.silentRefreshPostMessageEventListener&&(window.removeEventListener("message",this.silentRefreshPostMessageEventListener),this.silentRefreshPostMessageEventListener=null)}setupSilentRefreshEventListener(){this.removeSilentRefreshEventListener(),this.silentRefreshPostMessageEventListener=e=>{let t=this.processMessageEventMessage(e);this.checkOrigin&&e.origin!==location.origin&&console.error("wrong origin requested silent refresh!"),this.tryLogin({customHashFragment:t,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri||this.redirectUri}).catch(s=>this.debug("tryLogin during silent refresh failed",s))},window.addEventListener("message",this.silentRefreshPostMessageEventListener)}silentRefresh(e={},t=!0){let s=this.getIdentityClaims()||{};if(this.useIdTokenHintForSilentRefresh&&this.hasValidIdToken()&&(e.id_token_hint=this.getIdToken()),!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(typeof this.document>"u")throw new Error("silent refresh is not supported on this platform");let i=this.document.getElementById(this.silentRefreshIFrameName);i&&this.document.body.removeChild(i),this.silentRefreshSubject=s.sub;let o=this.document.createElement("iframe");o.id=this.silentRefreshIFrameName,this.setupSilentRefreshEventListener();let c=this.silentRefreshRedirectUri||this.redirectUri;this.createLoginUrl(null,null,c,t,e).then(u=>{o.setAttribute("src",u),this.silentRefreshShowIFrame||(o.style.display="none"),this.document.body.appendChild(o)});let a=this.events.pipe(P(u=>u instanceof M),W()),l=this.events.pipe(P(u=>u.type==="token_received"),W()),h=p(new M("silent_refresh_timeout",null)).pipe(yt(this.silentRefreshTimeout));return Mn([a,l,h]).pipe(C(u=>{if(u instanceof M)throw u.type==="silent_refresh_timeout"?this.eventsSubject.next(u):(u=new M("silent_refresh_error",u),this.eventsSubject.next(u)),u;return u.type==="token_received"&&(u=new j("silently_refreshed"),this.eventsSubject.next(u)),u})).toPromise()}initImplicitFlowInPopup(e){return this.initLoginFlowInPopup(e)}initLoginFlowInPopup(e){return e=e||{},this.createLoginUrl(null,null,this.silentRefreshRedirectUri,!1,{display:"popup"}).then(t=>new Promise((s,i)=>{let c=null;e.windowRef?e.windowRef&&!e.windowRef.closed&&(c=e.windowRef,c.location.href=t):c=window.open(t,"ngx-oauth2-oidc-login",this.calculatePopupFeatures(e));let a,l=g=>{this.tryLogin({customHashFragment:g,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri}).then(()=>{u(),s(!0)},v=>{u(),i(v)})},h=()=>{(!c||c.closed)&&(u(),i(new M("popup_closed",{})))};c?a=window.setInterval(h,500):i(new M("popup_blocked",{}));let u=()=>{window.clearInterval(a),window.removeEventListener("storage",d),window.removeEventListener("message",f),c!==null&&c.close(),c=null},f=g=>{let v=this.processMessageEventMessage(g);v&&v!==null?(window.removeEventListener("storage",d),l(v)):console.log("false event firing")},d=g=>{g.key==="auth_hash"&&(window.removeEventListener("message",f),l(g.newValue))};window.addEventListener("message",f),window.addEventListener("storage",d)}))}calculatePopupFeatures(e){let t=e.height||470,s=e.width||500,i=window.screenLeft+(window.outerWidth-s)/2,o=window.screenTop+(window.outerHeight-t)/2;return`location=no,toolbar=no,width=${s},height=${t},top=${o},left=${i}`}processMessageEventMessage(e){let t="#";if(this.silentRefreshMessagePrefix&&(t+=this.silentRefreshMessagePrefix),!e||!e.data||typeof e.data!="string")return;let s=e.data;if(s.startsWith(t))return"#"+s.substr(t.length)}canPerformSessionCheck(){return this.sessionChecksEnabled?this.sessionCheckIFrameUrl?this.getSessionState()?!(typeof this.document>"u"):(console.warn("sessionChecksEnabled is activated but there is no session_state"),!1):(console.warn("sessionChecksEnabled is activated but there is no sessionCheckIFrameUrl"),!1):!1}setupSessionCheckEventListener(){this.removeSessionCheckEventListener(),this.sessionCheckEventListener=e=>{let t=e.origin.toLowerCase(),s=this.issuer.toLowerCase();if(this.debug("sessionCheckEventListener"),!s.startsWith(t)){this.debug("sessionCheckEventListener","wrong origin",t,"expected",s,"event",e);return}switch(e.data){case"unchanged":this.ngZone.run(()=>{this.handleSessionUnchanged()});break;case"changed":this.ngZone.run(()=>{this.handleSessionChange()});break;case"error":this.ngZone.run(()=>{this.handleSessionError()});break}this.debug("got info from session check inframe",e)},this.ngZone.runOutsideAngular(()=>{window.addEventListener("message",this.sessionCheckEventListener)})}handleSessionUnchanged(){this.debug("session check","session unchanged"),this.eventsSubject.next(new Z("session_unchanged"))}handleSessionChange(){this.eventsSubject.next(new Z("session_changed")),this.stopSessionCheckTimer(),!this.useSilentRefresh&&this.responseType==="code"?this.refreshToken().then(()=>{this.debug("token refresh after session change worked")}).catch(()=>{this.debug("token refresh did not work after session changed"),this.eventsSubject.next(new Z("session_terminated")),this.logOut(!0)}):this.silentRefreshRedirectUri?(this.silentRefresh().catch(()=>this.debug("silent refresh failed after session changed")),this.waitForSilentRefreshAfterSessionChange()):(this.eventsSubject.next(new Z("session_terminated")),this.logOut(!0))}waitForSilentRefreshAfterSessionChange(){this.events.pipe(P(e=>e.type==="silently_refreshed"||e.type==="silent_refresh_timeout"||e.type==="silent_refresh_error"),W()).subscribe(e=>{e.type!=="silently_refreshed"&&(this.debug("silent refresh did not work after session changed"),this.eventsSubject.next(new Z("session_terminated")),this.logOut(!0))})}handleSessionError(){this.stopSessionCheckTimer(),this.eventsSubject.next(new Z("session_error"))}removeSessionCheckEventListener(){this.sessionCheckEventListener&&(window.removeEventListener("message",this.sessionCheckEventListener),this.sessionCheckEventListener=null)}initSessionCheck(){if(!this.canPerformSessionCheck())return;let e=this.document.getElementById(this.sessionCheckIFrameName);e&&this.document.body.removeChild(e);let t=this.document.createElement("iframe");t.id=this.sessionCheckIFrameName,this.setupSessionCheckEventListener();let s=this.sessionCheckIFrameUrl;t.setAttribute("src",s),t.style.display="none",this.document.body.appendChild(t),this.startSessionCheckTimer()}startSessionCheckTimer(){this.stopSessionCheckTimer(),this.ngZone.runOutsideAngular(()=>{this.sessionCheckTimer=setInterval(this.checkSession.bind(this),this.sessionCheckIntervall)})}stopSessionCheckTimer(){this.sessionCheckTimer&&(clearInterval(this.sessionCheckTimer),this.sessionCheckTimer=null)}checkSession(){let e=this.document.getElementById(this.sessionCheckIFrameName);e||this.logger.warn("checkSession did not find iframe",this.sessionCheckIFrameName);let t=this.getSessionState();t||this.stopSessionCheckTimer();let s=this.clientId+" "+t;e.contentWindow.postMessage(s,this.issuer)}createLoginUrl(){return te(this,arguments,function*(e="",t="",s="",i=!1,o={}){let c=this,a;s?a=s:a=this.redirectUri;let l=yield this.createAndSaveNonce();if(e?e=l+this.config.nonceStateSeparator+encodeURIComponent(e):e=l,!this.requestAccessToken&&!this.oidc)throw new Error("Either requestAccessToken or oidc or both must be true");this.config.responseType?this.responseType=this.config.responseType:this.oidc&&this.requestAccessToken?this.responseType="id_token token":this.oidc&&!this.requestAccessToken?this.responseType="id_token":this.responseType="token";let h=c.loginUrl.indexOf("?")>-1?"&":"?",u=c.scope;this.oidc&&!u.match(/(^|\s)openid($|\s)/)&&(u="openid "+u);let f=c.loginUrl+h+"response_type="+encodeURIComponent(c.responseType)+"&client_id="+encodeURIComponent(c.clientId)+"&state="+encodeURIComponent(e)+"&redirect_uri="+encodeURIComponent(a)+"&scope="+encodeURIComponent(u);if(this.responseType.includes("code")&&!this.disablePKCE){let[d,g]=yield this.createChallangeVerifierPairForPKCE();this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.setItem("PKCE_verifier",g):this._storage.setItem("PKCE_verifier",g),f+="&code_challenge="+d,f+="&code_challenge_method=S256"}t&&(f+="&login_hint="+encodeURIComponent(t)),c.resource&&(f+="&resource="+encodeURIComponent(c.resource)),c.oidc&&(f+="&nonce="+encodeURIComponent(l)),i&&(f+="&prompt=none");for(let d of Object.keys(o))f+="&"+encodeURIComponent(d)+"="+encodeURIComponent(o[d]);if(this.customQueryParams)for(let d of Object.getOwnPropertyNames(this.customQueryParams))f+="&"+d+"="+encodeURIComponent(this.customQueryParams[d]);return f})}initImplicitFlowInternal(e="",t=""){if(this.inImplicitFlow)return;if(this.inImplicitFlow=!0,!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let s={},i=null;typeof t=="string"?i=t:typeof t=="object"&&(s=t),this.createLoginUrl(e,i,null,!1,s).then(this.config.openUri).catch(o=>{console.error("Error in initImplicitFlow",o),this.inImplicitFlow=!1})}initImplicitFlow(e="",t=""){this.loginUrl!==""?this.initImplicitFlowInternal(e,t):this.events.pipe(P(s=>s.type==="discovery_document_loaded")).subscribe(()=>this.initImplicitFlowInternal(e,t))}resetImplicitFlow(){this.inImplicitFlow=!1}callOnTokenReceivedIfExists(e){let t=this;if(e.onTokenReceived){let s={idClaims:t.getIdentityClaims(),idToken:t.getIdToken(),accessToken:t.getAccessToken(),state:t.state};e.onTokenReceived(s)}}storeAccessTokenResponse(e,t,s,i,o){if(this._storage.setItem("access_token",e),i&&!Array.isArray(i)?this._storage.setItem("granted_scopes",JSON.stringify(i.split(" "))):i&&Array.isArray(i)&&this._storage.setItem("granted_scopes",JSON.stringify(i)),this._storage.setItem("access_token_stored_at",""+this.dateTimeService.now()),s){let c=s*1e3,l=this.dateTimeService.new().getTime()+c;this._storage.setItem("expires_at",""+l)}t&&this._storage.setItem("refresh_token",t),o&&o.forEach((c,a)=>{this._storage.setItem(a,c)})}tryLogin(e=null){return this.config.responseType==="code"?this.tryLoginCodeFlow(e).then(()=>!0):this.tryLoginImplicitFlow(e)}parseQueryString(e){return!e||e.length===0?{}:(e.charAt(0)==="?"&&(e=e.substr(1)),this.urlHelper.parseQueryString(e))}tryLoginCodeFlow(e=null){return te(this,null,function*(){e=e||{};let t=e.customHashFragment?e.customHashFragment.substring(1):window.location.search,s=this.getCodePartsFromUrl(t),i=s.code,o=s.state,c=s.session_state;if(!e.preventClearHashAfterLogin){let h=location.origin+location.pathname+location.search.replace(/code=[^&$]*/,"").replace(/scope=[^&$]*/,"").replace(/state=[^&$]*/,"").replace(/session_state=[^&$]*/,"").replace(/^\?&/,"?").replace(/&$/,"").replace(/^\?$/,"").replace(/&+/g,"&").replace(/\?&/,"?").replace(/\?$/,"")+location.hash;history.replaceState(null,window.name,h)}let[a,l]=this.parseState(o);if(this.state=l,s.error){this.debug("error trying to login"),this.handleLoginError(e,s);let h=new M("code_error",{},s);return this.eventsSubject.next(h),Promise.reject(h)}if(!e.disableNonceCheck){if(!a)return this.saveRequestedRoute(),Promise.resolve();if(!e.disableOAuth2StateCheck&&!this.validateNonce(a)){let u=new M("invalid_nonce_in_state",null);return this.eventsSubject.next(u),Promise.reject(u)}}return this.storeSessionState(c),i&&(yield this.getTokenFromCode(i,e),this.restoreRequestedRoute()),Promise.resolve()})}saveRequestedRoute(){this.config.preserveRequestedRoute&&this._storage.setItem("requested_route",window.location.pathname+window.location.search)}restoreRequestedRoute(){let e=this._storage.getItem("requested_route");e&&history.replaceState(null,"",window.location.origin+e)}getCodePartsFromUrl(e){return!e||e.length===0?this.urlHelper.getHashFragmentParams():(e.charAt(0)==="?"&&(e=e.substr(1)),this.urlHelper.parseQueryString(e))}getTokenFromCode(e,t){let s=new z({encoder:new Se}).set("grant_type","authorization_code").set("code",e).set("redirect_uri",t.customRedirectUri||this.redirectUri);if(!this.disablePKCE){let i;this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?i=localStorage.getItem("PKCE_verifier"):i=this._storage.getItem("PKCE_verifier"),i?s=s.set("code_verifier",i):console.warn("No PKCE verifier found in oauth storage!")}return this.fetchAndProcessToken(s,t)}fetchAndProcessToken(e,t){t=t||{},this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let s=new D().set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){let i=btoa(`${this.clientId}:${this.dummyClientSecret}`);s=s.set("Authorization","Basic "+i)}return this.useHttpBasicAuth||(e=e.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(e=e.set("client_secret",this.dummyClientSecret)),new Promise((i,o)=>{if(this.customQueryParams)for(let c of Object.getOwnPropertyNames(this.customQueryParams))e=e.set(c,this.customQueryParams[c]);this.http.post(this.tokenEndpoint,e,{headers:s}).subscribe(c=>{this.debug("refresh tokenResponse",c),this.storeAccessTokenResponse(c.access_token,c.refresh_token,c.expires_in||this.fallbackAccessTokenExpirationTimeInSec,c.scope,this.extractRecognizedCustomParameters(c)),this.oidc&&c.id_token?this.processIdToken(c.id_token,c.access_token,t.disableNonceCheck).then(a=>{this.storeIdToken(a),this.eventsSubject.next(new j("token_received")),this.eventsSubject.next(new j("token_refreshed")),i(c)}).catch(a=>{this.eventsSubject.next(new M("token_validation_error",a)),console.error("Error validating tokens"),console.error(a),o(a)}):(this.eventsSubject.next(new j("token_received")),this.eventsSubject.next(new j("token_refreshed")),i(c))},c=>{console.error("Error getting token",c),this.eventsSubject.next(new M("token_refresh_error",c)),o(c)})})}tryLoginImplicitFlow(e=null){e=e||{};let t;e.customHashFragment?t=this.urlHelper.getHashFragmentParams(e.customHashFragment):t=this.urlHelper.getHashFragmentParams(),this.debug("parsed url",t);let s=t.state,[i,o]=this.parseState(s);if(this.state=o,t.error){this.debug("error trying to login"),this.handleLoginError(e,t);let u=new M("token_error",{},t);return this.eventsSubject.next(u),Promise.reject(u)}let c=t.access_token,a=t.id_token,l=t.session_state,h=t.scope;if(!this.requestAccessToken&&!this.oidc)return Promise.reject("Either requestAccessToken or oidc (or both) must be true.");if(this.requestAccessToken&&!c||this.requestAccessToken&&!e.disableOAuth2StateCheck&&!s||this.oidc&&!a)return Promise.resolve(!1);if(this.sessionChecksEnabled&&!l&&this.logger.warn("session checks (Session Status Change Notification) were activated in the configuration but the id_token does not contain a session_state claim"),this.requestAccessToken&&!e.disableNonceCheck&&!this.validateNonce(i)){let f=new M("invalid_nonce_in_state",null);return this.eventsSubject.next(f),Promise.reject(f)}return this.requestAccessToken&&this.storeAccessTokenResponse(c,null,t.expires_in||this.fallbackAccessTokenExpirationTimeInSec,h),this.oidc?this.processIdToken(a,c,e.disableNonceCheck).then(u=>e.validationHandler?e.validationHandler({accessToken:c,idClaims:u.idTokenClaims,idToken:u.idToken,state:s}).then(()=>u):u).then(u=>(this.storeIdToken(u),this.storeSessionState(l),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&this.clearLocationHash(),this.eventsSubject.next(new j("token_received")),this.callOnTokenReceivedIfExists(e),this.inImplicitFlow=!1,!0)).catch(u=>(this.eventsSubject.next(new M("token_validation_error",u)),this.logger.error("Error validating tokens"),this.logger.error(u),Promise.reject(u))):(this.eventsSubject.next(new j("token_received")),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&this.clearLocationHash(),this.callOnTokenReceivedIfExists(e),Promise.resolve(!0))}parseState(e){let t=e,s="";if(e){let i=e.indexOf(this.config.nonceStateSeparator);i>-1&&(t=e.substr(0,i),s=e.substr(i+this.config.nonceStateSeparator.length))}return[t,s]}validateNonce(e){let t;return this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?t=localStorage.getItem("nonce"):t=this._storage.getItem("nonce"),t!==e?(console.error("Validating access_token failed, wrong state/nonce.",t,e),!1):!0}storeIdToken(e){this._storage.setItem("id_token",e.idToken),this._storage.setItem("id_token_claims_obj",e.idTokenClaimsJson),this._storage.setItem("id_token_expires_at",""+e.idTokenExpiresAt),this._storage.setItem("id_token_stored_at",""+this.dateTimeService.now())}storeSessionState(e){this._storage.setItem("session_state",e)}getSessionState(){return this._storage.getItem("session_state")}handleLoginError(e,t){e.onLoginError&&e.onLoginError(t),this.clearHashAfterLogin&&!e.preventClearHashAfterLogin&&this.clearLocationHash()}getClockSkewInMsec(e=6e5){return!this.clockSkewInSec&&this.clockSkewInSec!==0?e:this.clockSkewInSec*1e3}processIdToken(e,t,s=!1){let i=e.split("."),o=this.padBase64(i[0]),c=fi(o),a=JSON.parse(c),l=this.padBase64(i[1]),h=fi(l),u=JSON.parse(h),f;if(this.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?f=localStorage.getItem("nonce"):f=this._storage.getItem("nonce"),Array.isArray(u.aud)){if(u.aud.every(T=>T!==this.clientId)){let T="Wrong audience: "+u.aud.join(",");return this.logger.warn(T),Promise.reject(T)}}else if(u.aud!==this.clientId){let T="Wrong audience: "+u.aud;return this.logger.warn(T),Promise.reject(T)}if(!u.sub){let T="No sub claim in id_token";return this.logger.warn(T),Promise.reject(T)}if(this.sessionChecksEnabled&&this.silentRefreshSubject&&this.silentRefreshSubject!==u.sub){let T=`After refreshing, we got an id_token for another user (sub). Expected sub: ${this.silentRefreshSubject}, received sub: ${u.sub}`;return this.logger.warn(T),Promise.reject(T)}if(!u.iat){let T="No iat claim in id_token";return this.logger.warn(T),Promise.reject(T)}if(!this.skipIssuerCheck&&u.iss!==this.issuer){let T="Wrong issuer: "+u.iss;return this.logger.warn(T),Promise.reject(T)}if(!s&&u.nonce!==f){let T="Wrong nonce: "+u.nonce;return this.logger.warn(T),Promise.reject(T)}if(Object.prototype.hasOwnProperty.call(this,"responseType")&&(this.responseType==="code"||this.responseType==="id_token")&&(this.disableAtHashCheck=!0),!this.disableAtHashCheck&&this.requestAccessToken&&!u.at_hash){let T="An at_hash is needed!";return this.logger.warn(T),Promise.reject(T)}let d=this.dateTimeService.now(),g=u.iat*1e3,v=u.exp*1e3,b=this.getClockSkewInMsec();if(g-b>=d||v+b-this.decreaseExpirationBySec<=d){let T="Token has expired";return console.error(T),console.error({now:d,issuedAtMSec:g,expiresAtMSec:v}),Promise.reject(T)}let E={accessToken:t,idToken:e,jwks:this.jwks,idTokenClaims:u,idTokenHeader:a,loadKeys:()=>this.loadJwks()};return this.disableAtHashCheck?this.checkSignature(E).then(()=>({idToken:e,idTokenClaims:u,idTokenClaimsJson:h,idTokenHeader:a,idTokenHeaderJson:c,idTokenExpiresAt:v})):this.checkAtHash(E).then(T=>{if(!this.disableAtHashCheck&&this.requestAccessToken&&!T){let k="Wrong at_hash";return this.logger.warn(k),Promise.reject(k)}return this.checkSignature(E).then(()=>{let k=!this.disableAtHashCheck,ie={idToken:e,idTokenClaims:u,idTokenClaimsJson:h,idTokenHeader:a,idTokenHeaderJson:c,idTokenExpiresAt:v};return k?this.checkAtHash(E).then(ee=>{if(this.requestAccessToken&&!ee){let oe="Wrong at_hash";return this.logger.warn(oe),Promise.reject(oe)}else return ie}):ie})})}getIdentityClaims(){let e=this._storage.getItem("id_token_claims_obj");return e?JSON.parse(e):null}getGrantedScopes(){let e=this._storage.getItem("granted_scopes");return e?JSON.parse(e):null}getIdToken(){return this._storage?this._storage.getItem("id_token"):null}padBase64(e){for(;e.length%4!==0;)e+="=";return e}getAccessToken(){return this._storage?this._storage.getItem("access_token"):null}getRefreshToken(){return this._storage?this._storage.getItem("refresh_token"):null}getAccessTokenExpiration(){return this._storage.getItem("expires_at")?parseInt(this._storage.getItem("expires_at"),10):null}getAccessTokenStoredAt(){return parseInt(this._storage.getItem("access_token_stored_at"),10)}getIdTokenStoredAt(){return parseInt(this._storage.getItem("id_token_stored_at"),10)}getIdTokenExpiration(){return this._storage.getItem("id_token_expires_at")?parseInt(this._storage.getItem("id_token_expires_at"),10):null}hasValidAccessToken(){if(this.getAccessToken()){let e=this._storage.getItem("expires_at"),t=this.dateTimeService.new();return!(e&&parseInt(e,10)-this.decreaseExpirationBySec<t.getTime()-this.getClockSkewInMsec())}return!1}hasValidIdToken(){if(this.getIdToken()){let e=this._storage.getItem("id_token_expires_at"),t=this.dateTimeService.new();return!(e&&parseInt(e,10)-this.decreaseExpirationBySec<t.getTime()-this.getClockSkewInMsec())}return!1}getCustomTokenResponseProperty(e){return this._storage&&this.config.customTokenParameters&&this.config.customTokenParameters.indexOf(e)>=0&&this._storage.getItem(e)!==null?JSON.parse(this._storage.getItem(e)):null}authorizationHeader(){return"Bearer "+this.getAccessToken()}logOut(e={},t=""){let s=!1;typeof e=="boolean"&&(s=e,e={});let i=this.getIdToken();if(this._storage.removeItem("access_token"),this._storage.removeItem("id_token"),this._storage.removeItem("refresh_token"),this.saveNoncesInLocalStorage?(localStorage.removeItem("nonce"),localStorage.removeItem("PKCE_verifier")):(this._storage.removeItem("nonce"),this._storage.removeItem("PKCE_verifier")),this._storage.removeItem("expires_at"),this._storage.removeItem("id_token_claims_obj"),this._storage.removeItem("id_token_expires_at"),this._storage.removeItem("id_token_stored_at"),this._storage.removeItem("access_token_stored_at"),this._storage.removeItem("granted_scopes"),this._storage.removeItem("session_state"),this.config.customTokenParameters&&this.config.customTokenParameters.forEach(c=>this._storage.removeItem(c)),this.silentRefreshSubject=null,this.eventsSubject.next(new Z("logout")),!this.logoutUrl||s)return;let o;if(!this.validateUrlForHttps(this.logoutUrl))throw new Error("logoutUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(this.logoutUrl.indexOf("{{")>-1)o=this.logoutUrl.replace(/\{\{id_token\}\}/,encodeURIComponent(i)).replace(/\{\{client_id\}\}/,encodeURIComponent(this.clientId));else{let c=new z({encoder:new Se});i&&(c=c.set("id_token_hint",i));let a=this.postLogoutRedirectUri||this.redirectUriAsPostLogoutRedirectUriFallback&&this.redirectUri||"";a&&(c=c.set("post_logout_redirect_uri",a),t&&(c=c.set("state",t)));for(let l in e)c=c.set(l,e[l]);o=this.logoutUrl+(this.logoutUrl.indexOf("?")>-1?"&":"?")+c.toString()}this.config.openUri(o)}createAndSaveNonce(){let e=this;return this.createNonce().then(function(t){return e.saveNoncesInLocalStorage&&typeof window.localStorage<"u"?localStorage.setItem("nonce",t):e._storage.setItem("nonce",t),t})}ngOnDestroy(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.removeSilentRefreshEventListener();let e=this.document.getElementById(this.silentRefreshIFrameName);e&&e.remove(),this.stopSessionCheckTimer(),this.removeSessionCheckEventListener();let t=this.document.getElementById(this.sessionCheckIFrameName);t&&t.remove()}createNonce(){return new Promise(e=>{if(this.rngUrl)throw new Error("createNonce with rng-web-api has not been implemented so far");let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=45,i="",o=typeof self>"u"?null:self.crypto||self.msCrypto;if(o){let c=new Uint8Array(s);o.getRandomValues(c),c.map||(c.map=Array.prototype.map),c=c.map(a=>t.charCodeAt(a%t.length)),i=String.fromCharCode.apply(null,c)}else for(;0<s--;)i+=t[Math.random()*t.length|0];e(pi(i))})}checkAtHash(e){return te(this,null,function*(){return this.tokenValidationHandler?this.tokenValidationHandler.validateAtHash(e):(this.logger.warn("No tokenValidationHandler configured. Cannot check at_hash."),!0)})}checkSignature(e){return this.tokenValidationHandler?this.tokenValidationHandler.validateSignature(e):(this.logger.warn("No tokenValidationHandler configured. Cannot check signature."),Promise.resolve(null))}initLoginFlow(e="",t={}){return this.responseType==="code"?this.initCodeFlow(e,t):this.initImplicitFlow(e,t)}initCodeFlow(e="",t={}){this.loginUrl!==""?this.initCodeFlowInternal(e,t):this.events.pipe(P(s=>s.type==="discovery_document_loaded")).subscribe(()=>this.initCodeFlowInternal(e,t))}initCodeFlowInternal(e="",t={}){if(!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let s={},i=null;typeof t=="string"?i=t:typeof t=="object"&&(s=t),this.createLoginUrl(e,i,null,!1,s).then(this.config.openUri).catch(o=>{console.error("Error in initAuthorizationCodeFlow"),console.error(o)})}createChallangeVerifierPairForPKCE(){return te(this,null,function*(){if(!this.crypto)throw new Error("PKCE support for code flow needs a CryptoHander. Did you import the OAuthModule using forRoot() ?");let e=yield this.createNonce(),t=yield this.crypto.calcHash(e,"sha-256");return[pi(t),e]})}extractRecognizedCustomParameters(e){let t=new Map;return this.config.customTokenParameters&&this.config.customTokenParameters.forEach(s=>{e[s]&&t.set(s,JSON.stringify(e[s]))}),t}revokeTokenAndLogout(e={},t=!1){let s=this.revocationEndpoint,i=this.getAccessToken(),o=this.getRefreshToken();if(!i)return Promise.resolve();let c=new z({encoder:new Se}),a=new D().set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){let l=btoa(`${this.clientId}:${this.dummyClientSecret}`);a=a.set("Authorization","Basic "+l)}if(this.useHttpBasicAuth||(c=c.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(c=c.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(let l of Object.getOwnPropertyNames(this.customQueryParams))c=c.set(l,this.customQueryParams[l]);return new Promise((l,h)=>{let u,f;if(i){let d=c.set("token",i).set("token_type_hint","access_token");u=this.http.post(s,d,{headers:a})}else u=p(null);if(o){let d=c.set("token",o).set("token_type_hint","refresh_token");f=this.http.post(s,d,{headers:a})}else f=p(null);t&&(u=u.pipe(q(d=>d.status===0?p(null):re(d))),f=f.pipe(q(d=>d.status===0?p(null):re(d)))),Le([u,f]).subscribe(d=>{this.logOut(e),l(d),this.logger.info("Token successfully revoked")},d=>{this.logger.error("Error revoking token",d),this.eventsSubject.next(new M("token_revoke_error",d)),h(d)})})}clearLocationHash(){location.hash!=""&&(location.hash="")}static{this.\u0275fac=function(t){return new(t||r)(w(G),w(Cr),w(er,8),w(tr,8),w(Ne,8),w(gi),w(Yt),w(rr,8),w(L),w(mt))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})(),nr=class{},Sn=class{handleError(n){return re(n)}},pc=(()=>{class r{constructor(e,t,s){this.oAuthService=e,this.errorHandler=t,this.moduleConfig=s}checkUrl(e){return this.moduleConfig.resourceServer.customUrlValidation?this.moduleConfig.resourceServer.customUrlValidation(e):this.moduleConfig.resourceServer.allowedUrls?!!this.moduleConfig.resourceServer.allowedUrls.find(t=>e.toLowerCase().startsWith(t.toLowerCase())):!0}intercept(e,t){let s=e.url.toLowerCase();return!this.moduleConfig||!this.moduleConfig.resourceServer||!this.checkUrl(s)?t.handle(e):this.moduleConfig.resourceServer.sendAccessToken?_n(p(this.oAuthService.getAccessToken()).pipe(P(o=>!!o)),this.oAuthService.events.pipe(P(o=>o.type==="token_received"),En(this.oAuthService.waitForTokenInMsec||0),q(()=>p(null)),C(()=>this.oAuthService.getAccessToken()))).pipe(ce(1),F(o=>{if(o){let c="Bearer "+o,a=e.headers.set("Authorization",c);e=e.clone({headers:a})}return t.handle(e).pipe(q(c=>this.errorHandler.handleError(c)))})):t.handle(e).pipe(q(o=>this.errorHandler.handleError(o)))}static{this.\u0275fac=function(t){return new(t||r)(w(vi),w(nr),w(Xt,8))}}static{this.\u0275prov=R({token:r,factory:r.\u0275fac})}}return r})();function gc(){return console}function mc(){return typeof sessionStorage<"u"?sessionStorage:new ac}function Ql(r=null,n=wn){return pe([vi,gi,{provide:Yt,useFactory:gc},{provide:er,useFactory:mc},{provide:tr,useClass:n},{provide:rr,useClass:fc},{provide:nr,useClass:Sn},{provide:Xt,useValue:r},{provide:ws,useClass:pc,multi:!0},{provide:mt,useClass:oc}])}var Zl=new _("AUTH_CONFIG");export{Pc as a,Ts as b,Jc as c,Kc as d,ho as e,Vo as f,di as g,Ll as h,vi as i,Ql as j};
